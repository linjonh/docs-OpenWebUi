---
sidebar_position: 3
title: "â›‘ï¸ äº‹ä»¶"
---

# â›‘ï¸ äº‹ä»¶ï¼šåœ¨ Open WebUI ä¸­ä½¿ç”¨ `__event_emitter__` å’Œ `__event_call__`

Open WebUI çš„æ’ä»¶æ¶æ„ä¸ä»…ä»…æ˜¯è¾“å…¥å¤„ç†å’Œè¾“å‡ºç”Ÿæˆâ€”â€”**å®ƒå¼ºè°ƒä¸ UI å’Œç”¨æˆ·ä¹‹é—´çš„å®æ—¶äº¤äº’**ã€‚ä¸ºäº†è®©æ‚¨çš„å·¥å…·ã€å‡½æ•°å’Œç®¡é“æ›´åŠ åŠ¨æ€ï¼ŒOpen WebUI æä¾›äº†é€šè¿‡ `__event_emitter__` å’Œ `__event_call__` å®ç°çš„å†…ç½®äº‹ä»¶ç³»ç»Ÿã€‚

æœ¬æŒ‡å—è§£é‡Šäº†**ä»€ä¹ˆæ˜¯äº‹ä»¶**ã€**å¦‚ä½•åœ¨ä»£ç ä¸­è§¦å‘å®ƒä»¬**ä»¥åŠ**æ‚¨å¯ä»¥ä½¿ç”¨çš„å®Œæ•´äº‹ä»¶ç±»å‹ç›®å½•**ï¼ˆåŒ…æ‹¬è¿œä¸æ­¢ `"input"` è¿™ç§ï¼‰ã€‚

---

## ğŸŒŠ ä»€ä¹ˆæ˜¯äº‹ä»¶ï¼Ÿ

**äº‹ä»¶**æ˜¯ä»åç«¯ä»£ç ï¼ˆå·¥å…·æˆ–å‡½æ•°ï¼‰å‘é€åˆ° Web UI çš„å®æ—¶é€šçŸ¥æˆ–äº¤äº’è¯·æ±‚ã€‚å®ƒä»¬å…è®¸æ‚¨æ›´æ–°èŠå¤©ã€æ˜¾ç¤ºé€šçŸ¥ã€è¯·æ±‚ç¡®è®¤ã€è¿è¡Œ UI æµç¨‹ç­‰ç­‰ã€‚

- ä½¿ç”¨ `__event_emitter__` è¾…åŠ©å‡½æ•°å‘é€äº‹ä»¶ç”¨äºå•å‘æ›´æ–°ï¼›å½“éœ€è¦ç”¨æˆ·è¾“å…¥æˆ–å“åº”ï¼ˆæ¯”å¦‚ç¡®è®¤ã€è¾“å…¥ç­‰ï¼‰æ—¶ï¼Œä½¿ç”¨ `__event_call__`ã€‚

**æ¯”å–»:**
å¯ä»¥å°†äº‹ä»¶æƒ³è±¡æˆæ¨é€é€šçŸ¥å’Œæ¨¡å¼å¯¹è¯æ¡†ï¼Œæ‚¨çš„æ’ä»¶å¯ä»¥è§¦å‘è¿™äº›äº‹ä»¶ï¼Œä»è€Œä¸°å¯Œå¹¶å¢å¼ºèŠå¤©ä½“éªŒçš„äº¤äº’æ€§ã€‚

---

## ğŸ§° åŸºæœ¬ç”¨æ³•

### å‘é€äº‹ä»¶

æ‚¨å¯ä»¥åœ¨å·¥å…·æˆ–å‡½æ•°çš„ä»»æ„ä½ç½®é€šè¿‡è°ƒç”¨è§¦å‘äº‹ä»¶ï¼š

```python
await __event_emitter__(
    {
        "type": "status",  # è¯·å‚è€ƒä¸‹é¢çš„äº‹ä»¶ç±»å‹åˆ—è¡¨
        "data": {
            "description": "å¤„ç†å·²å¼€å§‹ï¼",
            "done": False,
            "hidden": False,
        },
    }
)
```

æ‚¨**æ— éœ€**æ‰‹åŠ¨æ·»åŠ åƒ `chat_id` æˆ– `message_id` è¿™æ ·çš„å­—æ®µâ€”â€”è¿™äº›ç”± Open WebUI è‡ªåŠ¨å¤„ç†ã€‚

### äº¤äº’å¼äº‹ä»¶

å½“æ‚¨éœ€è¦æš‚åœæ‰§è¡Œä»¥ç­‰å¾…ç”¨æˆ·å“åº”ï¼ˆå¦‚ç¡®è®¤/å–æ¶ˆå¯¹è¯æ¡†ã€ä»£ç æ‰§è¡Œæˆ–è¾“å…¥ï¼‰æ—¶ï¼Œè¯·ä½¿ç”¨ `__event_call__`ï¼š

```python
result = await __event_call__(
    {
        "type": "input",  # æˆ– "confirmation", "execute"
        "data": {
            "title": "è¯·è¾“å…¥æ‚¨çš„å¯†ç ",
            "message": "æ­¤æ“ä½œéœ€è¦å¯†ç ",
            "placeholder": "åœ¨æ­¤è¾“å…¥æ‚¨çš„å¯†ç ",
        },
    }
)
# result å°†åŒ…å«ç”¨æˆ·è¾“å…¥çš„å€¼
```

---

## ğŸ“œ äº‹ä»¶è´Ÿè½½ç»“æ„

å½“æ‚¨å‘å‡ºæˆ–è°ƒç”¨äº‹ä»¶æ—¶ï¼ŒåŸºæœ¬ç»“æ„å¦‚ä¸‹ï¼š

```json
{
  "type": "event_type",   // è¯·å‚é˜…ä¸‹é¢çš„å®Œæ•´åˆ—è¡¨
  "data": { ... }         // äº‹ä»¶ç‰¹å®šçš„è´Ÿè½½
}
```

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨åªéœ€è®¾ç½® `"type"` å’Œ `"data"`ã€‚Open WebUI ä¼šè‡ªåŠ¨å¡«å……è·¯ç”±ä¿¡æ¯ã€‚

---

## ğŸ—‚ æ”¯æŒçš„äº‹ä»¶ç±»å‹å®Œæ•´åˆ—è¡¨

ä»¥ä¸‹æ˜¯**æ‰€æœ‰æ”¯æŒçš„ `type` å€¼**çš„å®Œæ•´è¡¨æ ¼ï¼Œå¹¶é™„ä¸Šå…¶é¢„æœŸæ•ˆæœå’Œæ•°æ®ç»“æ„ã€‚ï¼ˆåŸºäº Open WebUI äº‹ä»¶å¤„ç†é€»è¾‘çš„æœ€æ–°åˆ†æï¼‰

| ç±»å‹                        | ä½¿ç”¨åœºæ™¯                                   | æ•°æ®è´Ÿè½½ç»“æ„ï¼ˆç¤ºä¾‹ï¼‰                                  |
|-----------------------------|-------------------------------------------|--------------------------------------------------------------------|
| `status`                    | æ˜¾ç¤ºæ¶ˆæ¯çš„çŠ¶æ€æ›´æ–°/å†å²è®°å½•    | `{description: ..., done: bool, hidden: bool}`                     |
| `chat:completion`           | æä¾›èŠå¤©å®Œæˆç»“æœ                 | ï¼ˆè‡ªå®šä¹‰ï¼Œè¯·å‚é˜… Open WebUI å†…éƒ¨æ–‡æ¡£ï¼‰                           |
| `chat:message:delta`,<br/>`message` | å‘å½“å‰æ¶ˆæ¯è¿½åŠ å†…å®¹              | `{content: "è¿½åŠ çš„æ–‡æœ¬"}`                                      |
| `chat:message`,<br/>`replace`        | å®Œå…¨æ›¿æ¢å½“å‰æ¶ˆæ¯å†…å®¹          | `{content: "æ›¿æ¢çš„æ–‡æœ¬"}`                                    |
| `chat:message:files`,<br/>`files`   | è®¾ç½®æˆ–è¦†ç›–æ¶ˆæ¯æ–‡ä»¶ï¼ˆç”¨äºä¸Šä¼ æˆ–è¾“å‡ºï¼‰ | `{files: [...]}`                                                   |
| `chat:title`                | è®¾ç½®ï¼ˆæˆ–æ›´æ–°ï¼‰èŠå¤©ä¼šè¯æ ‡é¢˜   | ä¸»é¢˜å­—ç¬¦ä¸²æˆ– `{title: ...}`                                      |
| `chat:tags`                 | æ›´æ–°èŠå¤©çš„æ ‡ç­¾é›†             | æ ‡ç­¾æ•°ç»„æˆ–å¯¹è±¡                                                |
| `source`,<br/>`citation`              | æ·»åŠ æ¥æº/å¼•ç”¨æˆ–ä»£ç æ‰§è¡Œç»“æœ     | å…³äºä»£ç ï¼šå‚è§ [ä¸‹æ–‡ã€‚](#ä»£ç æ‰§è¡Œäº‹ä»¶)                      |
| `notification`              | åœ¨ UI ä¸­æ˜¾ç¤ºé€šçŸ¥ï¼ˆâ€œå¼¹å‡ºæç¤ºâ€ï¼‰       | `{type: "info" æˆ– "success" æˆ– "error" æˆ– "warning", content: "..."}`      |
| `confirmation` <br/>(éœ€è¦ `__event_call__`) | è¯·æ±‚ç¡®è®¤ï¼ˆç¡®å®š/å–æ¶ˆå¯¹è¯æ¡†ï¼‰         | `{title: "...", message: "..."}`                                   |
| `input` <br/>(éœ€è¦ `__event_call__`)    | è¯·æ±‚ç®€å•ç”¨æˆ·è¾“å…¥ï¼ˆâ€œè¾“å…¥æ¡†â€å¯¹è¯æ¡†ï¼‰      | `{title: "...", message: "...", placeholder: "...", value: ...}`   |
| `execute` <br/>(éœ€è¦ `__event_call__`)  | è¯·æ±‚ç”¨æˆ·ç«¯æ‰§è¡Œä»£ç å¹¶è¿”å›ç»“æœ  | `{code: "...javascript code..."}`                                  |

**å…¶ä»–/é«˜çº§ç±»å‹ï¼š**

- æ‚¨å¯ä»¥åœ¨UIå±‚å®šä¹‰è‡ªå·±çš„ç±»å‹å¹¶å¤„ç†å®ƒä»¬ï¼ˆæˆ–è€…ä½¿ç”¨å³å°†æ¨å‡ºçš„äº‹ä»¶æ‰©å±•æœºåˆ¶ï¼‰ã€‚

### â— ç‰¹å®šäº‹ä»¶ç±»å‹çš„è¯¦ç»†ä¿¡æ¯
### `status`

åœ¨UIä¸­æ˜¾ç¤ºçŠ¶æ€/è¿›åº¦æ›´æ–°ï¼š

```python
await __event_emitter__(
    {
        "type": "status",
        "data": {
            "description": "æ­¥éª¤ 1/3ï¼šæ­£åœ¨è·å–æ•°æ®...",
            "done": False,
            "hidden": False,
        },
    }
)
```

---

### `chat:message:delta` æˆ– `message`

**æµå¼è¾“å‡º**ï¼ˆè¿½åŠ æ–‡æœ¬ï¼‰ï¼š

```python
await __event_emitter__(
    {
        "type": "chat:message:delta",  # æˆ–ç®€å•å†™ä½œ "message"
        "data": {
            "content": "éƒ¨åˆ†æ–‡æœ¬ï¼Œ"
        },
    }
)

# åç»­ç”Ÿæˆæ›´å¤šå†…å®¹æ—¶ï¼š
await __event_emitter__(
    {
        "type": "chat:message:delta",
        "data": {
            "content": "å“åº”çš„ä¸‹ä¸€ä¸ªéƒ¨åˆ†ã€‚"
        },
    }
)
```

---

### `chat:message` æˆ– `replace`

**è®¾ç½®ï¼ˆæˆ–æ›¿æ¢ï¼‰æ•´ä¸ªæ¶ˆæ¯å†…å®¹ï¼š**

```python
await __event_emitter__(
    {
        "type": "chat:message",  # æˆ– "replace"
        "data": {
            "content": "æœ€ç»ˆçš„å®Œæ•´å“åº”ã€‚"
        },
    }
)
```

---

### `files` æˆ– `chat:message:files`

**é™„åŠ æˆ–æ›´æ–°æ–‡ä»¶ï¼š**

```python
await __event_emitter__(
    {
        "type": "files",  # æˆ– "chat:message:files"
        "data": {
            "files": [
               # Open WebUI æ–‡ä»¶å¯¹è±¡
            ]
        },
    }
)
```

---

### `chat:title`

**æ›´æ–°èŠå¤©æ ‡é¢˜ï¼š**

```python
await __event_emitter__(
    {
        "type": "chat:title",
        "data": {
            "title": "å¸‚åœºåˆ†ææœºå™¨äººä¼šè¯"
        },
    }
)
```

---

### `chat:tags`

**æ›´æ–°èŠå¤©æ ‡ç­¾ï¼š**

```python
await __event_emitter__(
    {
        "type": "chat:tags",
        "data": {
            "tags": ["é‡‘è", "AI", "æ¯æ—¥æ±‡æŠ¥"]
        },
    }
)
```

---

### `source` æˆ– `citation`ï¼ˆä»¥åŠä»£ç æ‰§è¡Œï¼‰

**æ·»åŠ å‚è€ƒ/å¼•ç”¨ï¼š**

```python
await __event_emitter__(
    {
        "type": "source",  # æˆ– "citation"
        "data": {
            # Open WebUI å¼•ç”¨å¯¹è±¡
        }
    }
)
```

**å¯¹äºä»£ç æ‰§è¡Œï¼ˆè·Ÿè¸ªæ‰§è¡ŒçŠ¶æ€ï¼‰ï¼š**

```python
await __event_emitter__(
    {
        "type": "source",
        "data": {
            # Open WebUI ä»£ç å¼•ç”¨å¯¹è±¡
        }
    }
)
```

---

### `notification`

**æ˜¾ç¤ºä¸€ä¸ªå¼¹å‡ºé€šçŸ¥ï¼š**

```python
await __event_emitter__(
    {
        "type": "notification",
        "data": {
            "type": "info",  # "success", "warning", "error"
            "content": "æ“ä½œå·²æˆåŠŸå®Œæˆï¼"
        }
    }
)
```

---

### `confirmation`ï¼ˆ**éœ€è¦** `__event_call__`ï¼‰

**æ˜¾ç¤ºä¸€ä¸ªç¡®è®¤å¯¹è¯æ¡†å¹¶è·å–ç”¨æˆ·å“åº”ï¼š**

```python
result = await __event_call__(
    {
        "type": "confirmation",
        "data": {
            "title": "æ‚¨ç¡®å®šå—ï¼Ÿ",
            "message": "æ‚¨çœŸçš„å¸Œæœ›ç»§ç»­æ“ä½œå—ï¼Ÿ"
        }
    }
)

if result:  # æˆ–æ£€æŸ¥resultçš„å†…å®¹
    await __event_emitter__({
        "type": "notification",
        "data": {"type": "success", "content": "ç”¨æˆ·ç¡®è®¤äº†æ“ä½œã€‚"}
    })
else:
    await __event_emitter__({
        "type": "notification",
        "data": {"type": "warning", "content": "ç”¨æˆ·å–æ¶ˆäº†æ“ä½œã€‚"}
    })
```

---

### `input`ï¼ˆ**éœ€è¦** `__event_call__`ï¼‰

**æç¤ºç”¨æˆ·è¾“å…¥æ–‡æœ¬ï¼š**

```python
result = await __event_call__(
    {
        "type": "input",
        "data": {
            "title": "è¯·è¾“å…¥æ‚¨çš„å§“å",
            "message": "æˆ‘ä»¬éœ€è¦æ‚¨çš„å§“åä»¥ç»§ç»­ã€‚",
            "placeholder": "æ‚¨çš„å…¨å"
        }
    }
)

user_input = result
await __event_emitter__(
    {
        "type": "notification",
        "data": {"type": "info", "content": f"æ‚¨è¾“å…¥çš„æ˜¯ï¼š{user_input}"}
    }
)
```

---

### `execute`ï¼ˆ**éœ€è¦** `__event_call__`ï¼‰

**åœ¨ç”¨æˆ·ç«¯åŠ¨æ€è¿è¡Œä»£ç ï¼š**

```python
result = await __event_call__(
    {
        "type": "execute",
        "data": {
            "code": "print(40 + 2);",
        }
    }
)

await __event_emitter__(
    {
        "type": "notification",
        "data": {
            "type": "info",
            "content": f"ä»£ç å·²æ‰§è¡Œï¼Œç»“æœï¼š{result}"
        }
    }
)
```

---

## ğŸ—ï¸ äº‹ä»¶çš„ä½¿ç”¨æ—¶æœºä¸åœºæ™¯

- **ä»Open WebUIçš„ä»»ä½•å·¥å…·æˆ–åŠŸèƒ½è°ƒç”¨ã€‚**
- ç”¨äº**æµå¼å“åº”**ã€æ˜¾ç¤ºè¿›åº¦ã€è¯·æ±‚ç”¨æˆ·æ•°æ®ã€æ›´æ–°UIæˆ–å±•ç¤ºè¡¥å……ä¿¡æ¯/æ–‡ä»¶ã€‚
- `await __event_emitter__` é€‚ç”¨äºå•å‘æ¶ˆæ¯ï¼ˆè§¦å‘åæ— éœ€ç®¡å…¶ç»“æœï¼‰ã€‚
- `await __event_call__` ç”¨äºéœ€è¦ä»ç”¨æˆ·è·å–å“åº”çš„æƒ…å†µï¼ˆè¾“å…¥ã€æ‰§è¡Œã€ç¡®è®¤ï¼‰ã€‚

---

## ğŸ’¡ æç¤ºä¸é«˜çº§æ³¨æ„äº‹é¡¹

- **æ¯æ¡æ¶ˆæ¯æ”¯æŒå¤šç§ç±»å‹ï¼š** æ‚¨å¯ä»¥ä¸ºä¸€æ¡æ¶ˆæ¯å‘å‡ºå¤šä¸ªä¸åŒç±»å‹çš„äº‹ä»¶ï¼Œä¾‹å¦‚ï¼Œæ˜¾ç¤º`status`æ›´æ–°ï¼Œç„¶åä»¥`chat:message:delta`æµå¼æ¶ˆæ¯ï¼Œæœ€åä»¥`chat:message`å®Œæˆã€‚
- **è‡ªå®šä¹‰äº‹ä»¶ç±»å‹ï¼š** è™½ç„¶ä¸Šè¿°åˆ—è¡¨æ˜¯æ ‡å‡†ç±»å‹ï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰ç±»å‹å¹¶åœ¨UIä»£ç ä¸­æ£€æµ‹/å¤„ç†å®ƒä»¬ã€‚
- **æ‰©å±•æ€§:** äº‹ä»¶ç³»ç»Ÿè¢«è®¾è®¡ä¸ºå¯æ‰©å±•â€”â€”å§‹ç»ˆæŸ¥çœ‹ [Open WebUI æ–‡æ¡£](https://github.com/open-webui/open-webui)ï¼Œä»¥è·å–æœ€æ–°çš„åˆ—è¡¨å’Œé«˜çº§ç”¨æ³•ã€‚

---

## ğŸ§ å¸¸è§é—®é¢˜

### é—®: å¦‚ä½•è§¦å‘ç”¨æˆ·é€šçŸ¥ï¼Ÿ
ä½¿ç”¨ `notification` ç±»å‹ï¼š
```python
await __event_emitter__({
    "type": "notification",
    "data": {"type": "success", "content": "ä»»åŠ¡å®Œæˆ"}
})
```

### é—®: å¦‚ä½•æç¤ºç”¨æˆ·è¾“å…¥å¹¶è·å–ä»–ä»¬çš„ç­”æ¡ˆï¼Ÿ
ä½¿ç”¨ï¼š
```python
response = await __event_call__({
    "type": "input",
    "data": {
        "title": "ä½ çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ",
        "message": "è¯·è¾“å…¥ä½ å–œæ¬¢çš„åå­—ï¼š",
        "placeholder": "åå­—"
    }
})
# response å°†æ˜¯: {"value": "ç”¨æˆ·çš„ç­”æ¡ˆ"}
```

### é—®: `__event_call__` æœ‰å“ªäº›äº‹ä»¶ç±»å‹å¯ç”¨ï¼Ÿ
- `"input"`: è¾“å…¥æ¡†å¯¹è¯æ¡†
- `"confirmation"`: æ˜¯/å¦ï¼Œç¡®å®š/å–æ¶ˆå¯¹è¯æ¡†
- `"execute"`: åœ¨å®¢æˆ·ç«¯è¿è¡Œæä¾›çš„ä»£ç å¹¶è¿”å›ç»“æœ

### é—®: æˆ‘å¯ä»¥æ›´æ–°é™„åŠ åˆ°æ¶ˆæ¯çš„æ–‡ä»¶å—ï¼Ÿ
å¯ä»¥â€”â€”ä½¿ç”¨ `"files"` æˆ– `"chat:message:files"` äº‹ä»¶ç±»å‹ï¼Œå¹¶æºå¸¦ `{files: [...]}` è´Ÿè½½ã€‚

### é—®: æˆ‘å¯ä»¥æ›´æ–°å¯¹è¯æ ‡é¢˜æˆ–æ ‡ç­¾å—ï¼Ÿ
å½“ç„¶å¯ä»¥ï¼šåˆ†åˆ«ä½¿ç”¨ `"chat:title"` æˆ– `"chat:tags"`ã€‚

### é—®: æˆ‘å¯ä»¥å‘ç”¨æˆ·æµå¼ä¼ è¾“å“åº”ï¼ˆéƒ¨åˆ†ä»¤ç‰Œï¼‰å—ï¼Ÿ
å¯ä»¥â€”â€”å¾ªç¯å‘å°„ `"chat:message:delta"` äº‹ä»¶ï¼Œç„¶åä»¥ `"chat:message"` å®Œæˆã€‚

---

## ğŸ“ ç»“è®º

**äº‹ä»¶** åœ¨ Open WebUI å†…ä¸ºæ‚¨æä¾›å®æ—¶äº’åŠ¨çš„è¶…çº§èƒ½åŠ›ã€‚å®ƒä»¬å¯ä»¥è®©æ‚¨çš„ä»£ç æ›´æ–°å†…å®¹ã€è§¦å‘é€šçŸ¥ã€è¯·æ±‚ç”¨æˆ·è¾“å…¥ã€æµå¼ä¼ è¾“ç»“æœã€å¤„ç†ä»£ç ç­‰â€”â€”å°†æ‚¨çš„åç«¯æ™ºèƒ½æ— ç¼æ¥å…¥èŠå¤© UIã€‚

- ä½¿ç”¨ `__event_emitter__` è¿›è¡Œå•å‘çŠ¶æ€/å†…å®¹æ›´æ–°ã€‚
- ä½¿ç”¨ `__event_call__` è¿›è¡Œéœ€è¦ç”¨æˆ·äº¤äº’çš„æ“ä½œï¼ˆè¾“å…¥ã€ç¡®è®¤ã€æ‰§è¡Œï¼‰ã€‚

å‚è€ƒæœ¬æ–‡æ¡£ä»¥äº†è§£å¸¸è§äº‹ä»¶ç±»å‹å’Œç»“æ„ï¼Œå¹¶æ¢ç´¢ Open WebUI æºä»£ç æˆ–æ–‡æ¡£ï¼Œä»¥è·å–é‡å¤§æ›´æ–°æˆ–è‡ªå®šä¹‰äº‹ä»¶ï¼

---

**åœ¨ Open WebUI ä¸­æ„‰å¿«åœ°è¿›è¡Œäº‹ä»¶é©±åŠ¨ç¼–ç å§ï¼ğŸš€**