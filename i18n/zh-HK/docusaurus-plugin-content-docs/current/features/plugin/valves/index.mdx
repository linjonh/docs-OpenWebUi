---
sidebar_position: 3
title: "ğŸ”„ é–¥é–€"
---

## é–¥é–€

é–¥é–€ï¼ˆValvesï¼‰å’Œç”¨æˆ¶é–¥é–€ï¼ˆUserValvesï¼‰ç”¨æ–¼å…è¨±ç”¨æˆ¶æä¾›å‹•æ…‹çš„è©³ç´°ä¿¡æ¯ï¼Œä¾‹å¦‚ API é‡‘é‘°æˆ–é…ç½®é¸é …ã€‚é€™äº›å°‡æœƒåœ¨ GUI èœå–®ä¸­ç‚ºçµ¦å®šçš„åŠŸèƒ½å‰µå»ºä¸€å€‹å¯å¡«å……çš„æ¬„ä½æˆ–å¸ƒçˆ¾åˆ‡æ›é–‹é—œã€‚é€™äº›è¨­ç½®å§‹çµ‚æ˜¯å¯é¸çš„ï¼Œä½†å¼·çƒˆå»ºè­°ä½¿ç”¨ã€‚

å› æ­¤ï¼ŒValves å’Œ UserValves é¡å¯åœ¨ `Pipe`ã€`Pipeline`ã€`Filter` æˆ– `Tools` é¡ä¸­å®šç¾©ã€‚

Valves åƒ…ç”±ç®¡ç†å“¡é€šé Tools æˆ– Functions èœå–®é€²è¡Œé…ç½®ã€‚è€Œ UserValves å¯ç”±ä»»ä½•ç”¨æˆ¶ç›´æ¥å¾èŠå¤©æœƒè©±ä¸­é€²è¡Œé…ç½®ã€‚

<details>
<summary>è¨»è§£ç¤ºä¾‹</summary>

```python

from pydantic import BaseModel, Field
from typing import Literal

# å®šç¾©å’Œé–¥é–€
class Filter:
   # æ³¨æ„ç•¶å‰çš„ç¸®é€²ï¼šValves å’Œ UserValves å¿…é ˆä½œç‚º
   # Toolsã€Filter æˆ– Pipe é¡çš„å±¬æ€§è²æ˜ã€‚é€™è£¡æˆ‘å€‘ä»¥
   # Filter ç‚ºä¾‹ã€‚
    class Valves(BaseModel):
       # Valves å’Œ UserValves ç¹¼æ‰¿è‡ª pydantics BaseModelã€‚é€™
       # ä½¿å¾—å¯ä»¥è™•ç†è¤‡é›œçš„ä½¿ç”¨æ¡ˆä¾‹ï¼Œä¾‹å¦‚æ¨¡å‹æ ¡é©—ç­‰ã€‚
       test_valve: int = Field(  # æ³¨æ„é¡å‹æç¤ºï¼šå®ƒç”¨æ–¼
           # é¸æ“‡å‘ç”¨æˆ¶é¡¯ç¤ºçš„ UI å…ƒç´ é¡å‹ï¼ˆæŒ‰éˆ•ã€
           # æ–‡æœ¬ç­‰ï¼‰ã€‚
           default=4,
           description="ä¸€å€‹æ§åˆ¶æ•¸å€¼çš„é–¥é–€"
           # required=False,  # ä½ å¯ä»¥é€šé True ä¾†å¼·åˆ¶è¦æ±‚è¼¸å…¥å­—æ®µ
       )
       # å¦‚æœè¦ç‚ºç”¨æˆ¶æä¾›å¤šå€‹å­—ç¬¦ä¸²é¸æ“‡ï¼Œå¯ä»¥ä½¿ç”¨ Literalï¼š
       choice_option: Literal["choiceA", "choiceB"] = Field(
           default="choiceA",
           description="ä¸€å€‹å¤šé¸é–¥é–€çš„ç¤ºä¾‹",
       )
       priority: int = Field(
           default=0,
           description="éæ¿¾æ“ä½œçš„å„ªå…ˆç´šã€‚å€¼è¶Šä½çš„å„ªå…ˆé€šé"
       )
       # å„ªå…ˆç´šå­—æ®µæ˜¯å¯é¸çš„ï¼Œä½†å¦‚æœå­˜åœ¨ï¼Œå°‡ç”¨æ–¼
       # å°éæ¿¾å™¨æ’åºã€‚
       pass
       # æ³¨æ„ï¼Œæ­¤è™•çš„passæœ‰åŠ©æ–¼è§£æä¸¦ä¸”æ¨è–¦ä½¿ç”¨ã€‚

   # ç”¨æˆ¶é–¥é–€çš„å®šç¾©æ–¹å¼èˆ‡æ­¤ç›¸åŒã€‚
    class UserValves(BaseModel):
        test_user_valve: bool = Field(
            default=False, description="ä¸€å€‹æ§åˆ¶çœŸ/å‡ï¼ˆé–‹/é—œï¼‰é–‹é—œçš„ç”¨æˆ¶é–¥é–€"
       )
       pass

   def __init__(self):
       self.valves = self.Valves()
       # å› ç‚ºå®ƒæ˜¯ç”±ç®¡ç†å“¡è¨­ç½®çš„ï¼ŒåŸ·è¡Œä»£ç¢¼æ™‚å¯ä»¥ç›´æ¥è¨ªå•ã€‚
       pass

   # å…¥å£æ–¹æ³•åƒ…ç”¨æ–¼ Filterï¼Œä½† __user__ çš„è™•ç†æ–¹å¼æ˜¯ç›¸åŒçš„
   def inlet(self, body: dict, __user__: dict):
       # ç”±æ–¼ UserValves æ˜¯æ¯å€‹ç”¨æˆ¶å®šç¾©çš„ï¼Œå®ƒåƒ…åœ¨ä½¿ç”¨æ™‚å¯ç”¨ã€‚
       # æ³¨æ„ï¼Œé›–ç„¶ __user__ æ˜¯ä¸€å€‹å­—å…¸ï¼Œä½† __user__["valves"] æ˜¯ä¸€å€‹
       # UserValves å°è±¡ã€‚å› æ­¤ï¼Œä½ å¯ä»¥åƒé€™æ¨£è¨ªå•å…¶å€¼ï¼š
       test_user_valve = __user__["valves"].test_user_valve
       # æˆ–è€…ï¼š
       test_user_valve = dict(__user__["valves"])["test_user_valve"]
       # ä½†é€™å°‡è¿”å›é»˜èªå€¼è€Œä¸æ˜¯å¯¦éš›å€¼ï¼š
       # test_user_valve = __user__["valves"]["test_user_valve"]  # ä¸è¦é€™æ¨£åšï¼
```

</details>
