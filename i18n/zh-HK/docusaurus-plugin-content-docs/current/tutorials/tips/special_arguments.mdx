---
sidebar_position: 20
title: "ğŸ’¡ ç‰¹æ®Šåƒæ•¸"
---

:::warning
æœ¬æ•™ç¨‹ç‚ºç¤¾ç¾¤è²¢ç»ï¼Œé Open WebUI åœ˜éšŠæ”¯æŒã€‚å®ƒåƒ…ä½œç‚ºè‡ªè¨‚ Open WebUI çš„ç¯„ä¾‹èªªæ˜ã€‚æƒ³è¦è²¢ç»ï¼Ÿè«‹åƒé–±è²¢ç»æ•™ç¨‹ã€‚
:::

# ğŸ’¡ ç‰¹æ®Šåƒæ•¸

åœ¨é–‹ç™¼æ‚¨è‡ªå·±çš„ `å·¥å…·`ã€`åŠŸèƒ½`(`éæ¿¾å™¨`ã€`ç®¡é“` æˆ– `å‹•ä½œ`)ã€`ç®¡ç·š`ç­‰æ™‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ç‰¹æ®Šåƒæ•¸ä¾†æ¢ç´¢ Open-WebUI çš„å…¨éƒ¨åŠŸèƒ½ã€‚

æœ¬é æ—¨åœ¨è©³ç´°é—¡è¿°æ¯å€‹ç‰¹æ®Šåƒæ•¸çš„é¡å‹å’Œçµæ§‹ï¼Œä¸¦æä¾›ç¯„ä¾‹ã€‚

### `body`

`dict` é€šå¸¸å¹¾ä¹ç›´æ¥å‚³éåˆ°æ¨¡å‹ã€‚é›–ç„¶å®ƒä¸æ˜¯åš´æ ¼æ„ç¾©ä¸Šçš„ç‰¹æ®Šåƒæ•¸ï¼Œä½†åŸºæ–¼ä¾¿æ–¼æŸ¥é–±ä¸”å…¶æœ¬èº«åŒ…å«æŸäº›ç‰¹æ®Šåƒæ•¸ï¼Œå› æ­¤å°‡å…¶åˆ—å…¥æ­¤è™•ã€‚

<details>
<summary>ç¯„ä¾‹</summary>

```json

{
  "stream": true,
  "model": "my-cool-model",
  # å°å¯«å­—ä¸²ä¸¦ç”¨ - åˆ†éš”çš„è©ï¼šé€™æ˜¯æ¨¡å‹çš„ ID
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "åœ–ç‰‡ä¸­æ˜¯ä»€éº¼ï¼Ÿ"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdYAAAGcCAYAAABk2YF[REDACTED]"
            # åœ–ç‰‡ä»¥ base64 ç·¨ç¢¼æ•¸æ“šå‚³é
          }
        }
      ]
    },
    {
      "role": "assistant",
      "content": "è©²åœ–ç‰‡ä¼¼ä¹æ˜¯ [REDACTED]"
    },
  ],
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "stream_options": {
    "include_usage": true
  },
  "metadata": "[èˆ‡ __metadata__ å®Œå…¨ç›¸åŒçš„ dict]",
  "files": "[èˆ‡ __files__ å®Œå…¨ç›¸åŒçš„æ¸…å–®]"
}


```

</details>

### `__user__`

`dict` åŒ…å«ç”¨æˆ¶è³‡è¨Šã€‚

è«‹æ³¨æ„ï¼Œå¦‚æœå®šç¾©äº† `UserValves` é¡ï¼Œå…¶å¯¦ä¾‹éœ€é€šé `__user__["valves"]` è¨ªå•ã€‚å¦å‰‡ï¼Œ`valves` éµå€¼å®Œå…¨ç¼ºå¤±æ–¼ `__user__`ã€‚

<details>
<summary>ç¯„ä¾‹</summary>

```json
{
  "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "email": "cheesy_dude@openwebui.com",
  "name": "Patrick",
  "role": "user",
  # è§’è‰²å¯ä»¥æ˜¯ `user` æˆ– `admin`
  "valves": "[UserValve çš„å¯¦ä¾‹]"
}
```

</details>

### `__metadata__`

`dict` åŒ…å«æœ‰é—œèŠå¤©ã€æ¨¡å‹ã€æ–‡ä»¶ç­‰çš„å»£æ³›è³‡è¨Šã€‚

<details>
<summary>ç¯„ä¾‹</summary>

```json
{
  "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "chat_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "message_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "session_id": "xxxxxxxxxxxxxxxxxxxx",
  "tool_ids": null,
  # tool_ids æ˜¯ str æ¸…å–®ã€‚
  "tool_servers": [],
  "files": "[èˆ‡ body['files'] ç›¸åŒ]",
  # å¦‚æœæœªæä¾›æ–‡ä»¶ï¼Œå‰‡ __metadata__ åŒ…å« files éµï¼Œå…¶å€¼ç‚º []
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "variables": {
    "{{USER_NAME}}": "cheesy_username",
    "{{USER_LOCATION}}": "Unknown",
    "{{CURRENT_DATETIME}}": "2025-02-02 XX:XX:XX",
    "{{CURRENT_DATE}}": "2025-02-02",
    "{{CURRENT_TIME}}": "XX:XX:XX",
    "{{CURRENT_WEEKDAY}}": "Monday",
    "{{CURRENT_TIMEZONE}}": "Europe/Berlin",
    "{{USER_LANGUAGE}}": "en-US"
  },
  "model": "[èˆ‡ __model__ å®Œå…¨ç›¸åŒçš„ dict]",
  "direct": false,
  "function_calling": "native",
  "type": "user_response",
  "interface": "open-webui"
}

```

</details>

### `__model__`

`dict` åŒ…å«æœ‰é—œæ¨¡å‹çš„è³‡è¨Šã€‚

<details>
<summary>ç¯„ä¾‹</summary>

```json
{
  "id": "my-cool-model",
  "name": "My Cool Model",
  "object": "model",
  "created": 1746000000,
  "owned_by": "openai",
  # å¯ä»¥æ˜¯ openai æˆ– ollama
  "info": {
      "id": "my-cool-model",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "base_model_id": "gpt-4o",
      # å³æ¨¡å‹ç«¯é»æœå‹™çš„æ¨¡å‹åç¨±
      "name": "My Cool Model",
      "params": {
      "system": "ä½ æ˜¯æˆ‘æœ€æ£’çš„åŠ©æ‰‹ã€‚ä½ å›ç­” [REDACTED]",
      "function_calling": "native"
      # è‡ªè¨‚é¸é …æœƒé¡¯ç¤ºåœ¨é€™è£¡ï¼Œä¾‹å¦‚ "Top K"
      },
      "meta": {
      "profile_image_url": "/static/favicon.png",
      "description": "æè¿° my-cool-model",
      "capabilities": {
          "vision": true,
          "usage": true,
          "citations": true
      },
      "position": 17,
      "tags": [
          {
          "name": "for_friends"
          },
          {
          "name": "vision_enabled"
          }
      ],
      "suggestion_prompts": null
      },
      "access_control": {
      "read": {
          "group_ids": [],
          "user_ids": []
      },
      "write": {
          "group_ids": [],
          "user_ids": []
      }
      },
      "is_active": true,
      "updated_at": 1740000000,
      "created_at": 1740000000
  },
  "preset": true,
  "actions": [],
  "tags": [
      {
          "name": "for_friends"
      },
          "name": "vision_enabled"
      }
  ]
}

```

</details>

### `__messages__`

å…ˆå‰è¨Šæ¯çš„`list`ã€‚

è«‹åƒè€ƒä¸Šæ–¹`body["messages"]`çš„å€¼ã€‚


### `__chat_id__`

`chat_id`çš„`str`ã€‚

è«‹åƒè€ƒä¸Šæ–¹`__metadata__["chat_id"]`çš„å€¼ã€‚

### `__session_id__`

`session_id`çš„`str`ã€‚

è«‹åƒè€ƒä¸Šæ–¹`__metadata__["session_id"]`çš„å€¼ã€‚

### `__message_id__`

`message_id`çš„`str`ã€‚

è«‹åƒè€ƒä¸Šæ–¹`__metadata__["message_id"]`çš„å€¼ã€‚

### `__event_emitter__`

ç”¨æ–¼å‘ä½¿ç”¨è€…é¡¯ç¤ºäº‹ä»¶è³‡è¨Šçš„`Callable`ã€‚

### `__event_call__`

ç”¨æ–¼`Actions`çš„`Callable`ã€‚

### `__files__`

é€éèŠå¤©å‚³é€çš„`list`æª”æ¡ˆã€‚è«‹æ³¨æ„ï¼Œåœ–åƒä¸è¢«è¦–ç‚ºæª”æ¡ˆï¼Œä¸¦ç›´æ¥ä½œç‚º`body["messages"]`åˆ—è¡¨çš„ä¸€éƒ¨åˆ†å‚³é€è‡³æ¨¡å‹ã€‚

å‡ºæ–¼æ•ˆèƒ½ç†ç”±ï¼Œæª”æ¡ˆçš„å¯¦éš›äºŒä½å…ƒè³‡æ–™ä¸¦ä¸åŒ…å«åœ¨åƒæ•¸ä¸­ï¼Œä½†æª”æ¡ˆä»å¯é€éå…¶è·¯å¾‘è¢«è¨ªå•ï¼ˆå¦‚æœ‰éœ€è¦ï¼‰ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨`docker`çš„Pythonèªæ³•è·¯å¾‘å¯ä»¥æ˜¯ï¼š

```python
from pathlib import Path

the_file = Path(f"/app/backend/data/uploads/{__files__[0]["files"]["id"]}_{__files__[0]["files"]["filename"]}")
assert the_file.exists()
```

è«‹æ³¨æ„ï¼Œé€šé`__metadata__["files"]`ï¼ˆå…¶å€¼ç‚º`[]`ï¼Œå¦‚æœæœªå‚³é€æª”æ¡ˆï¼‰æˆ–é€šé`body["files"]`ä¹Ÿå¯è¨ªå•ç›¸åŒæª”æ¡ˆdictï¼ˆä½†å¦‚æœæœªå‚³é€æª”æ¡ˆï¼Œ`files`éµåœ¨`body`ä¸­å®Œå…¨ç¼ºå¤±ï¼‰ã€‚

<details>
<summary>ç¯„ä¾‹</summary>

```json

[
  {
    "type": "file",
    "file": {
      "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "filename": "Napoleon - Wikipedia.pdf",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "hash": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
      "data": {
        "content": "Napoleon - Wikipedia\n\n\nNapoleon I\n\nThe Emperor Napoleon in His Study at the\nTuileries, 1812\n\nEmperor of the French\n\n1st reign 18 May 1804 â€“ 6 April 1814\n\nSuccessor Louis XVIII[a]\n\n2nd reign 20 March 1815Â â€“ 22Â June 1815\n\nSuccessor Louis XVIII[a]\n\nFirst Consul of the French Republic\n\nIn office\n13 December 1799Â â€“ 18 May 1804\n\nBorn Napoleone Buonaparte\n15 August 1769\nAjaccio, Corsica, Kingdom of\nFrance\n\nDied 5 May 1821 (agedÂ 51)\nLongwood, Saint Helena\n\nBurial 15 December 1840\nLes Invalides, Paris\n\nNapoleon\nNapoleon Bonaparte[b] (born Napoleone\nBuonaparte;[1][c] 15 August 1769 â€“ 5 May 1821), later\nknown [REDACTED]",
        # æ­¤contentå€¼ç‚ºæ–‡ä»¶è§£æå™¨çš„è¼¸å‡ºï¼Œä¸Šè¿°ç¯„ä¾‹ä½¿ç”¨Tikaä½œç‚ºæ–‡ä»¶è§£æå™¨
      },
      "meta": {
        "name": "Napoleon - Wikipedia.pdf",
        "content_type": "application/pdf",
        "size": 10486578,
        # å–®ä½æ˜¯bytesï¼Œæ­¤ç¯„ä¾‹ç´„10Mb
        "data": {},
        "collection_name": "file-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
        # å§‹çµ‚ä»¥file é–‹é ­
      },
      "created_at": 1740000000,
      "updated_at": 1740000000
    },
    "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "url": "/api/v1/files/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "name": "Napoleon - Wikipedia.pdf",
    "collection_name": "file-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    "status": "uploaded",
    "size": 10486578,
    "error": "",
    "itemId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    # itemId èˆ‡ file["id"] ä¸åŒ
  }
]


```

</details>

### `__request__`

`fastapi.Request`å¯¦ä¾‹ã€‚å¯ä»¥åœ¨[è¿ç§»é é¢](../../features/plugin/migration/index.mdx)æˆ–[fastapisæ–‡æª”](https://fastapi.tiangolo.com/reference/request/)ä¸­ç­è§£æ›´å¤šè³‡è¨Šã€‚

### `__task__`

ä»»å‹™é¡å‹çš„`str`ã€‚å…¶å€¼åªæ˜¯`__metadata__["task"]`çš„ç°¡å¯«ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œå¦å‰‡ç‚º`None`ã€‚

<details>
<summary>å¯èƒ½çš„å€¼</summary>

```json

[
    "title_generation",
    "tags_generation",
    "emoji_generation",
    "query_generation",
    "image_prompt_generation",
    "autocomplete_generation",
    "function_calling",
    "moa_response_generation"
]
```

</details>

### `__task_body__`

åŒ…å«å®Œæˆçµ¦å®š`__task__`æ‰€éœ€`body`çš„`dict`ã€‚å…¶å€¼åªæ˜¯`__metadata__["task_body"]`çš„ç°¡å¯«ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œå¦å‰‡ç‚º`None`ã€‚

å…¶çµæ§‹èˆ‡ä¸Šè¿°`body`ç›¸åŒï¼Œä½†é€²è¡Œäº†ä¿®æ”¹ï¼Œä¾‹å¦‚ä½¿ç”¨é©åˆçš„æ¨¡å‹å’Œç³»çµ±è¨Šæ¯ç­‰ã€‚


### `__tools__`

`ToolUserModel`å¯¦ä¾‹çš„`list`ã€‚

é—œæ–¼`ToolUserModel`å¯¦ä¾‹çš„è©³ç´°å±¬æ€§ï¼Œå¯ä»¥æŸ¥çœ‹[tools.py](https://github.com/open-webui/open-webui/blob/main/backend/open_webui/models/tools.py)ä¸­çš„ç¨‹å¼ç¢¼ã€‚

