---
sidebar_position: 5
title: "🛠️ 本地开发指南"
---

# 准备好为 Open WebUI 做贡献了吗？让我们开始吧！🚀

想深入 Open WebUI 开发？这份全面的指南将快速轻松地引导您设置 **本地开发环境**。无论您是经验丰富的开发人员还是刚刚起步，我们都将帮助您准备好调整前端、增强后端，并为 Open WebUI 的未来做出贡献！让我们通过简单且详细的步骤来启动和运行您的开发环境吧！

## 前置条件

在开始之前，请确保您的系统满足以下最低要求：

- **操作系统：** Linux（或 Windows 的 WSL）、Windows 11 或 macOS。 *(推荐使用以获得最佳兼容性)*
- **Python:** **3.11 或更高**版本。 *(后端服务所需)*
- **Node.js:** **22.10 或更高**版本。 *(前端开发所需)*
- **推荐的 IDE：** 我们建议使用类似 [VSCode](https://code.visualstudio.com/) 的 IDE 来进行代码编辑、调试和使用集成终端。当然，您也可以使用您喜欢的 IDE！
- **[可选] GitHub Desktop：** 如果您对命令行 Git 不太熟悉，可以考虑安装 [GitHub Desktop](https://desktop.github.com/) 来更轻松地管理 Git 仓库。

## 设置本地开发环境

我们将设置 Open WebUI 的前端（用户界面）和后端（API 和服务器逻辑）。

### 1. 克隆仓库

首先，使用 `git clone` 将 Open WebUI 的仓库下载到您的本地机器。这将创建一个本地副本项目。

1. **打开您的终端**（如果您在 Windows 上并使用 Git Bash，则打开 Git Bash）。
2. **导航到您想存储 Open WebUI 项目的目录。**
3. **克隆该仓库：**运行以下命令：

```bash
git clone https://github.com/open-webui/open-webui.git
cd open-webui
```

   `git clone` 命令将项目文件从 GitHub 下载到您的本地机器。接下来的 `cd open-webui` 命令会将您导航到新创建的项目目录。

### 2. 前端设置（用户界面）

让我们先启动和运行用户界面（在浏览器中看到的内容）：

1. **配置环境变量：**
   - 将示例环境文件复制到 `.env`：

     ```bash
     cp -RPp .env.example .env
     ```

     此命令将 `.env.example` 文件复制为一个新文件 `.env`。`.env` 文件是您为前端配置环境变量的地方。

   - **自定义 `.env`：** 在代码编辑器（如 VSCode）中打开 `.env` 文件。此文件包含前端的配置变量，例如 API 端点和其他设置。对于本地开发，`.env.example` 中的默认设置通常已经足够，但您也可以根据需要进行自定义。

  **重要提示：** 如果您要向仓库贡献代码，请不要将敏感信息提交到 `.env` 文件中。

2. **安装前端依赖：**
   - **导航到前端目录：** 如果您还不在项目根目录（`open-webui` 目录），请确保您已经在其中。

     ```bash
     # 如果您不在项目根目录，请执行以下命令：
     cd open-webui
     ```

   - 安装所需的 JavaScript 包：

     ```bash
     npm install
     ```

     此命令使用 `npm`（Node 包管理器）读取项目根目录中的 `package.json` 文件，并下载所有必要的 JavaScript 库和工具以运行前端。这可能需要几分钟，具体取决于您的网络连接。

3. **启动前端开发服务器：**

     ```bash
     npm run dev
     ```

     此命令启动前端开发服务器。如果按照步骤成功完成，系统通常会提示服务器正在运行，并提供一个本地 URL。

     🎉 **访问前端：** 打开您的网页浏览器，进入 [http://localhost:5173](http://localhost:5173)。您应该会看到一条消息表明 Open WebUI 的前端正在运行，并等待后端可用。别担心这条消息！接下来我们设置后端。**保持此终端运行**——它正在为前端提供服务！

### 3. 后端设置（API 和服务器）

为了优化开发体验，我们 **强烈建议** 为前端和后端进程分别使用不同的终端实例。这可以让您的工作流程更加有序，并使得各部分的应用程序独立管理变得更加容易。

**为什么要分开使用终端？**

- **进程隔离：** 前端和后端开发服务器是独立的程序。在不同终端中运行它们可以确保它们不会相互干扰，并允许您独立地重启或停止它们。
- **更清晰的日志和输出：** 每个终端将显示特定于前端或后端的日志和输出。这使得调试和监控更容易，因为您不需要翻阅交错的日志。
- **减少终端混乱：** 在单个终端中混合前端和后端命令可能会导致混淆。分开的终端能够使您的命令历史和活动进程井然有序。
- **提高工作流效率：** 您可以在一个终端中处理前端任务（如运行 `npm run dev`），同时在另一个终端中管理后端任务（如启动服务器或检查日志），无需在一个终端中频繁切换上下文。

**使用 VSCode 集成终端（推荐）：**

VSCode 的集成终端功能使得管理多个终端变得非常简单。以下是如何利用它将前端和后端分离：

1. **前端终端（您很可能已经有了这个）：** 如果您按照前端设置步骤操作，您很可能已经在 VSCode 中打开了一个位于项目根目录（`open-webui` 目录）的终端。这是您运行前端命令（如 `npm run dev`）的地方。如果您尚未位于 `open-webui` 目录，请确保将其切换至该目录。

2. **后端终端（打开一个新的终端）：**
   - 在 VSCode 中，转到 **终端 > 新建终端**（或使用快捷键 `Ctrl+Shift+` 在 Windows/Linux 上，或 `Cmd+Shift+` 在 macOS 上）。这将打开一个新的集成终端面板。
   - **导航到 `backend` 目录：** 在这个*新*的终端中，使用 `cd backend` 命令切换到项目中的 `backend` 文件夹。这确保了所有后端相关的命令都在正确的上下文中执行。

   现在，您在 VSCode 中有了**两个独立的终端实例**：一个用于前端（可能在 `open-webui` 目录中），另一个专门用于后端（位于 `backend` 目录中）。您可以在 VSCode 中轻松地在这些终端之间切换，以独立管理前端和后端进程。此设置强烈推荐用于更简洁且更高效的开发工作流。

**后端设置步骤（在您的*后端*终端中）：**

1. **导航到后端目录：**（在前一步中，您应该已经在 `backend` 目录中了）。如果没有，请运行：

   ```bash
   cd backend
   ```

2. **创建并激活一个 Conda 环境（推荐）：**
   - 我们强烈推荐使用 Conda 来管理 Python 依赖并隔离您的项目环境。这可以避免与系统中其他 Python 项目发生冲突，并确保您使用正确的 Python 版本和库。

     ```bash
     conda create --name open-webui python=3.11
     conda activate open-webui
     ```

     - `conda create --name open-webui python=3.11`：该命令创建了一个名为 `open-webui` 的新 Conda 环境，并使用 Python 3.11 版本。如果您选择了不同的 Python 3.11.x 版本，也是可以的。
     - `conda activate open-webui`：该命令激活刚创建的 Conda 环境。一旦激活，您的终端提示符通常会更改，以指示您处于 `open-webui` 环境中（例如，提示符开头可能显示 `(open-webui)`）。
  
    **确保在继续操作之前在您的后端终端中激活环境。**

     *(使用 Conda 是可选的，但强烈建议用于管理 Python 依赖并避免冲突。)* 如果您选择不使用 Conda，请确保您使用的是 Python 3.11 或更高版本，然后继续下一步，但请注意潜在的依赖冲突。

1. **安装后端依赖：**
     - 在您的*后端*终端中（并且如果使用了 Conda，请确保 Conda 环境已被激活），运行：

     ```bash
     pip install -r requirements.txt -U
     ```

     该命令使用 `pip`（Python 包管理工具）读取 `backend` 目录中的 `requirements.txt` 文件。`requirements.txt` 列出了后端运行所需的所有 Python 库。`pip install` 下载并将这些库安装到您的活动 Python 环境中（如果您使用 Conda，则会安装到您的 Conda 环境中，否则会安装到系统范围的 Python 环境中）。`-U` 标志确保您安装到最新的兼容版本。

2. **启动后端开发服务器：**
     - 在您的*后端*终端中，运行：

     ```bash
     sh dev.sh
     ```

     该命令执行 `dev.sh` 脚本。该脚本可能包含启动后端开发服务器的命令。*（如果感兴趣，您可以在代码编辑器中打开并检查 `dev.sh` 文件，以查看实际运行的命令。）* 后端服务器通常会启动并在终端中打印一些输出。

📄 **查看 API 文档：** 启动后端后，可以在网络浏览器中访问自动生成的 API 文档，[http://localhost:8080/docs](http://localhost:8080/docs)。这些文档对于理解后端 API 的端点、如何与后端交互以及它期望和返回的数据非常有价值。在开发过程中请随时参考这些文档！

🎉 **恭喜！** 如果您按照所有步骤操作，现在应该能在本地同时运行前端和后端开发服务。回到之前在浏览器中打开的前端页面（通常是 [http://localhost:5173](http://localhost:5173)）。**刷新页面。** 现在，您应该能在浏览器中看到完整的 Open WebUI 应用程序，并连接到本地后端！

## 常见问题排查

以下是设置或开发过程中可能遇到的一些常见问题及其解决方法：

### 💥 "FATAL ERROR: Reached Heap Limit"（前端）

这个错误通常出现在前端开发过程中，表示 Node.js 在构建过程中内存不足，尤其是在处理大型前端应用时。

**解决方法：** 增加 Node.js 的堆大小。这会为 Node.js 提供更多可用内存。以下是几种方式：

1. **使用 `NODE_OPTIONS` 环境变量（推荐用于开发）：**
   - 这是一种临时为当前终端会话增加内存限制的方法。在您的 *前端* 终端运行 `npm run dev` 或 `npm run build` 之前，设置 `NODE_OPTIONS` 环境变量：

     ```bash
     export NODE_OPTIONS="--max-old-space-size=4096" # 对于 Linux/macOS（bash, zsh）
     # set NODE_OPTIONS=--max-old-space-size=4096 # 对于 Windows（命令提示符）
     # $env:NODE_OPTIONS="--max-old-space-size=4096" # 对于 Windows（PowerShell）
     npm run dev
     ```

     根据您的操作系统和终端选择适合的命令。`4096` 表示 4GB 内存。如果需要，可以尝试进一步提高该值（例如，`8192` 表示 8GB）。此设置仅适用于当前终端会话中运行的命令。

2. **修改 `Dockerfile`（适用于 Docker 环境）：**
   - 如果您使用 Docker，可以在 `Dockerfile` 中永久设置 `NODE_OPTIONS` 环境变量。这样可以在 Docker 环境中保持一致的内存分配，如以下示例所示：

     ```dockerfile
     ENV NODE_OPTIONS=--max-old-space-size=4096
     ```

   - **分配足够的 RAM：** 无论使用哪种方法，请确保您的系统或 Docker 容器有足够的 RAM 可供 Node.js 使用。**建议至少分配 4 GB RAM，** 对于较大的项目或复杂的构建可能需要更多。关闭不必要的应用程序以释放 RAM。

### ⚠️ 端口冲突（前端与后端）

如果您看到与端口相关的错误，例如 "Address already in use" 或 "Port already bound"，这表示您的系统上已有其他应用正在使用端口 `5173`（前端默认）或 `8080`（后端默认）。每个端口一次只能被一个应用占用。

**解决方法：**

1. **识别冲突的进程：** 您需要找出哪个应用正在使用所需端口。
   - **Linux/macOS：** 打开一个新终端，使用 `lsof` 或 `netstat` 命令：
     - `lsof -i :5173`（或 `:8080` 用于后端端口）
     - `netstat -tulnp | grep 5173`（或 `8080`）
     这些命令会列出使用指定端口的进程 ID（PID）及进程名称。
   - **Windows：** 以管理员身份打开命令提示符或 PowerShell，使用 `netstat` 或 `Get-NetTCPConnection`：
     - `netstat -ano | findstr :5173`（或 `:8080`）（命令提示符）
     - `Get-Process -Id (Get-NetTCPConnection -LocalPort 5173).OwningProcess`（PowerShell）
     这些命令也会显示使用该端口的进程 PID。

2. **终止冲突的进程：** 一旦确认了进程 ID（PID），您可以停止使用该端口的应用程序。**在终止进程时要小心，尤其是当您不确定其作用时。**
   - **Linux/macOS：** 使用 `kill` 命令：`kill <PID>`（将 `<PID>` 替换为实际进程 ID）。如果进程没有使用 `kill` 终止，则可以使用 `kill -9 <PID>`（强制终止），但请谨慎操作。
   - **Windows：** 在命令提示符或 PowerShell 中以管理员身份使用 `taskkill` 命令：`taskkill /PID <PID> /F`（将 `<PID>` 替换为进程 ID）。`/F` 标志强制终止。

3. **或者，更改端口（高级）：**
   - 如果您无法终止冲突的进程（例如，它是您需要的系统服务），可以配置 Open WebUI 以使用不同的前端和/或后端端口。这通常需要修改配置文件。
     - **前端端口：** 查看前端文档或配置文件（通常是 `vite.config.js` 或类似文件），了解如何更改开发服务器端口。如果前端使用环境变量指定端口，您可能还需要调整 `.env` 文件。
     - **后端端口：** 检查 `dev.sh` 脚本或后端配置文件以确定后端端口的设置方式。您可能需要修改启动命令或配置文件来更改后端端口。如果您更改了后端端口，可能还需要更新前端的 `.env` 文件，使其指向新的后端 URL。

### 🔄 热更新不起作用

热更新（或模块热替换 - HMR）是一项极好的开发功能，在您修改代码时会自动刷新浏览器。如果它无法正常工作，将会显著降低开发工作效率。

**排查步骤：**

1. **确认开发服务器正在运行：** 仔细检查 `npm run dev`（前端）和 `sh dev.sh`（后端）是否分别在它们对应的终端中运行，并确保没有遇到任何错误。在终端输出中查找显示它们正在运行以及处于“监视模式”或“开发模式”的消息。如果有错误，请先解决那些问题。
2. **检查监视模式/HMR消息：** 启动开发服务器时，终端通常会打印消息表明热更新或监视模式已启用。查找类似"HMR enabled"、"watching for file changes"之类的短语。如果未看到这些消息，可能存在配置问题。
3. **浏览器缓存：** 有时，由于浏览器缓存的原因，即便热更新正常工作，您可能也看不到最新的变化。尝试在浏览器中执行**强制刷新**：
   - **Windows/Linux：** Ctrl+Shift+R
   - **macOS：** Cmd+Shift+R
   - 或者，尝试清除浏览器缓存，或者在私人/隐身模式下打开前端页面。
4. **前端依赖问题：** 过时或损坏的前端依赖项有时可能妨碍热更新。尝试刷新您的前端依赖项：
   - 在您的*前端*终端中运行：
  
     ```bash
     rm -rf node_modules && npm install
     ```

     此命令将删除存放依赖项的 `node_modules` 目录，然后重新从头安装这些依赖。这可以解决因包损坏或过时导致的问题。
5. **后端需要重启（针对后端变化）：** 热更新通常最适用于前端代码的变化（UI、样式、组件）。对于重大后端代码的变化（尤其是服务器逻辑、API端点或依赖项的变化），您可能需要**手动重启后端服务器**（通过停止后端终端中的 `sh dev.sh` 然后重新运行）。后端变化的热更新通常不如前端变化可靠，或者在许多后端开发设置中并未自动化配置。
6. **IDE/编辑器问题：** 在极少数情况下，您的IDE或代码编辑器问题可能导致文件变化未被开发服务器正确检测到。尝试重启您的IDE，或者确保文件已正确保存。
7. **配置问题（高级）：** 如果上述步骤均无效，可能是前端或后端开发服务器设置中的复杂配置问题。请参阅项目的文档、配置文件（例如前端的 `vite.config.js`、后端服务器的配置文件），或者向 Open WebUI 社区或维护者寻求帮助。

## 为 Open WebUI 做贡献

我们热烈欢迎您为 Open WebUI 做出贡献！您的帮助对提升这个项目非常重要。以下是提供流畅、有效贡献工作流程的快速指南：

1. **理解项目结构：** 花点时间熟悉项目的目录结构，尤其是 `frontend` 和 `backend` 文件夹。查看代码、配置文件和文档，以了解项目是如何组织的。
2. **从小型贡献开始：** 如果您是项目的新手，可以考虑从小型贡献开始，例如：
   - **文档改进：** 修正错别字，优化说明，或为文档添加更多细节。
   - **修复漏洞：** 修复报告的漏洞或问题。
   - **小型UI增强：** 改进样式，修复轻微布局问题。
   这些小型贡献是熟悉代码库和贡献流程的好方法。
3. **在着手进行较大改动前讨论：** 如果您计划实施一个重要的新功能或进行大量修改，建议**先与项目维护人员或社区讨论您的想法。**您可以通过以下方式进行：
   - **在GitHub代码库上打开问题**以提议您的功能或修改。
   - **加入Open WebUI 社区频道**（若有，请参阅项目的README或网站以获取链接）并在其中讨论您的设想。
   这有助于确保您的贡献与项目目标保持一致，避免在可能不被合并的功能上浪费精力。
4. **为您的工作创建独立分支：** **切勿直接提交到 `dev` 分支。** 请为您正在开发的每个功能或漏洞修复创建一个新分支。这可以让您的修改保持独立，并方便管理以及提交拉取请求。
   - 要基于 `dev` 分支创建新分支（例如命名为 `my-feature-branch`）：
  
     ```bash
     git checkout dev
     git pull origin dev # 确保你的本地 dev 分支是最新的
     git checkout -b my-feature-branch
     ```

5. **频繁提交更改并撰写清晰的提交信息：** 在开发新功能或修复错误时，进行小且逻辑合理的提交。**撰写清晰简洁的提交信息**，说明你进行了哪些更改以及原因。良好的提交信息有助于理解变更历史，也对团队合作至关重要。
   - 示例：`Fix: 修正了后端设置文档中的拼写错误`
   - 示例：`Feat: 实现了用户个人资料页面，展示基本信息`
6. **定期与 `dev` 分支保持同步：** 在自己的分支上工作时，定期将分支与 `dev` 分支的最新更改进行同步，以尽量减少后期合并冲突的可能性：

   ```bash
   git checkout dev
   git pull origin dev
   git checkout my-feature-branch
   git merge dev
   ```

   在执行 `git merge` 步骤时，解决所有可能出现的合并冲突。
7. **在推送代码前运行测试（如果有）：** 尽管此指南未详细介绍 Open WebUI 的具体测试流程，但在推送前运行所有可用测试是一个很好的习惯。查阅项目文档或 `package.json`（针对前端）以及后端相关文件以找到测试命令（例如，`npm run test`, `pytest` 等）。运行测试有助于确保新更改未引入回归问题或破坏现有功能。
8. **提交拉取请求（PR）：** 当你的工作完成、（若有）测试通过并准备好贡献代码时，提交一个拉取请求（PR）到 Open WebUI 仓库的 `dev` 分支。
   - **进入 GitHub 上的 Open WebUI 仓库。**
   - **切换到你的分支。**
   - **点击“贡献”或“拉取请求”按钮**（通常是绿色的按钮）。
   - **填写 PR 表单：**
     - **标题：** 给你的 PR 起一个清晰描述性标题，总结你的更改（例如，"Fix: 修复登录表单验证问题"）。
     - **描述：** 提供更详细的描述内容，包括你所做的更改、解决的问题（如适用）及相关背景信息。如果有相关的问题单，请在描述中链接。
   - **提交 PR。**

   项目维护者将会审查你的拉取请求，提供反馈意见，并可能合并你的代码。请积极响应反馈并根据需要进行修改。

**感谢你阅读这份详细的指南，并对贡献 Open WebUI 表达兴趣！我们期待看到你的贡献，也欢迎你成为 Open WebUI 社区的一员！** 🎉 编码愉快！
