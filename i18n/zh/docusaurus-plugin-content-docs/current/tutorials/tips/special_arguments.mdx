---
sidebar_position: 20
title: "ğŸ’¡ ç‰¹æ®Šå‚æ•°"
---

:::è­¦å‘Š
æœ¬æ•™ç¨‹ä¸ºç¤¾åŒºè´¡çŒ®å†…å®¹ï¼Œä¸å— Open WebUI å›¢é˜Ÿæ”¯æŒï¼Œä»…ç”¨äºæ¼”ç¤ºå¦‚ä½•æ ¹æ®ç‰¹å®šä½¿ç”¨åœºæ™¯å®šåˆ¶ Open WebUIã€‚æƒ³è¦è´¡çŒ®ï¼Ÿè¯·æŸ¥çœ‹è´¡çŒ®æ•™ç¨‹ã€‚
:::

# ğŸ’¡ ç‰¹æ®Šå‚æ•°

å½“å¼€å‘æ‚¨è‡ªå·±çš„`å·¥å…·`ã€`åŠŸèƒ½`ï¼ˆåŒ…æ‹¬`è¿‡æ»¤å™¨`ã€`ç®¡é“`æˆ–`åŠ¨ä½œ`ï¼‰ã€`ç®¡é“`ç­‰æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå‚æ•°æ¥æ¢ç´¢ Open-WebUI æä¾›çš„å®Œæ•´åŠŸèƒ½èŒƒå›´ã€‚

æœ¬é¡µé¢æ—¨åœ¨è¯¦ç»†è¯´æ˜æ¯ä¸ªç‰¹æ®Šå‚æ•°çš„ç±»å‹å’Œç»“æ„ï¼Œå¹¶æä¾›ä¸€ä¸ªç¤ºä¾‹ã€‚

### `body`

`dict` é€šå¸¸ç›´æ¥ä¼ é€’ç»™æ¨¡å‹ã€‚è™½ç„¶å®ƒä¸å®Œå…¨æ˜¯ä¸€ä¸ªç‰¹æ®Šå‚æ•°ï¼Œä½†ç”±äºå…¶æœ¬èº«å«æœ‰ç‰¹æ®Šå‚æ•°ï¼Œæ•…åœ¨æ­¤å¤„åŒ…å«ä»¥ä¾¿äºå‚è€ƒã€‚

<details>
<summary>ç¤ºä¾‹</summary>

```json

{
  "stream": true,
  "model": "my-cool-model",
  # å°å†™å¸¦çŸ­æ¨ªçº¿çš„å­—ç¬¦ä¸²ï¼šè¿™æ˜¯æ¨¡å‹çš„ ID
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "è¿™å¼ å›¾ç‰‡é‡Œæœ‰ä»€ä¹ˆï¼Ÿ"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdYAAAGcCAYAAABk2YF[REDACTED]"
            # å›¾åƒä»¥ base64 ç¼–ç æ•°æ®ä¼ é€’
          }
        }
      ]
    },
    {
      "role": "assistant",
      "content": "å›¾ç‰‡ä¼¼ä¹æ˜¯ [REDACTED]"
    },
  ],
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "stream_options": {
    "include_usage": true
  },
  "metadata": "[ä¸ __metadata__ å®Œå…¨ç›¸åŒçš„ dict]",
  "files": "[ä¸ __files__ å®Œå…¨ç›¸åŒçš„åˆ—è¡¨]"
}


```

</details>

### `__user__`

åŒ…å«ç”¨æˆ·ä¿¡æ¯çš„ `dict`ã€‚

æ³¨æ„ï¼šå¦‚æœå®šä¹‰äº† `UserValves` ç±»ï¼Œåˆ™å¿…é¡»é€šè¿‡ `__user__["valves"]` è®¿é—®å…¶å®ä¾‹ï¼›å¦åˆ™ï¼Œ`valves` é”®å€¼åœ¨ `__user__` ä¸­å®Œå…¨ç¼ºå¤±ã€‚

<details>
<summary>ç¤ºä¾‹</summary>

```json
{
  "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "email": "cheesy_dude@openwebui.com",
  "name": "Patrick",
  "role": "user",
  # è§’è‰²å¯ä»¥æ˜¯ `user` æˆ– `admin`
  "valves": "[UserValve å®ä¾‹]"
}
```

</details>

### `__metadata__`

åŒ…å«æœ‰å…³èŠå¤©ã€æ¨¡å‹ã€æ–‡ä»¶ç­‰çš„å¹¿æ³›ä¿¡æ¯çš„ `dict`ã€‚

<details>
<summary>ç¤ºä¾‹</summary>

```json
{
  "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "chat_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "message_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "session_id": "xxxxxxxxxxxxxxxxxxxx",
  "tool_ids": null,
  # tool_ids æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ã€‚
  "tool_servers": [],
  "files": "[ä¸ body[files] ä¸€æ ·]",
  # å¦‚æœæœªæä¾›æ–‡ä»¶ï¼Œ`files` é”®ä»å­˜åœ¨äº __metadata__ ä¸­ï¼Œå…¶å€¼ä¸º []
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "variables": {
    "{{USER_NAME}}": "cheesy_username",
    "{{USER_LOCATION}}": "æœªçŸ¥",
    "{{CURRENT_DATETIME}}": "2025-02-02 XX:XX:XX",
    "{{CURRENT_DATE}}": "2025-02-02",
    "{{CURRENT_TIME}}": "XX:XX:XX",
    "{{CURRENT_WEEKDAY}}": "æ˜ŸæœŸä¸€",
    "{{CURRENT_TIMEZONE}}": "æ¬§æ´²/æŸæ—",
    "{{USER_LANGUAGE}}": "en-US"
  },
  "model": "[ä¸ __model__ å®Œå…¨ç›¸åŒçš„ dict]",
  "direct": false,
  "function_calling": "native",
  "type": "ç”¨æˆ·å“åº”",
  "interface": "open-webui"
}

```

</details>

### `__model__`

åŒ…å«æœ‰å…³æ¨¡å‹ä¿¡æ¯çš„ `dict`ã€‚

<details>
<summary>ç¤ºä¾‹</summary>

```json
{
  "id": "my-cool-model",
  "name": "æˆ‘çš„é…·æ¨¡å‹",
  "object": "æ¨¡å‹",
  "created": 1746000000,
  "owned_by": "openai",
  # å€¼ä¸º openai æˆ– ollama
  "info": {
      "id": "my-cool-model",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "base_model_id": "gpt-4o",
      # è¿™æ˜¯æ¨¡å‹ç«¯ç‚¹æä¾›çš„æ¨¡å‹åç§°
      "name": "æˆ‘çš„é…·æ¨¡å‹",
      "params": {
      "system": "ä½ æ˜¯æˆ‘æœ€å¥½çš„åŠ©æ‰‹ã€‚ä½ çš„å›ç­”æ˜¯ [REDACTED]",
      "function_calling": "native"
      # è‡ªå®šä¹‰é€‰é¡¹ï¼Œä¾‹å¦‚â€œTop Kâ€ï¼Œåœ¨æ­¤å¤„æ˜¾ç¤º
      },
      "meta": {
      "profile_image_url": "/static/favicon.png",
      "description": "my-cool-model çš„æè¿°",
      "capabilities": {
          "vision": true,
          "usage": true,
          "citations": true
      },
      "position": 17,
      "tags": [
          {
          "name": "ä¸º_æœ‹å‹"
          },
          {
          "name": "å¼€å¯è§†è§‰åŠŸèƒ½"
          }
      ],
      "suggestion_prompts": null
      },
      "access_control": {
      "read": {
          "group_ids": [],
          "user_ids": []
      },
      "write": {
          "group_ids": [],
          "user_ids": []
      }
      },
      "is_active": true,
      "updated_at": 1740000000,
      "created_at": 1740000000
  },
  "preset": true,
  "actions": [],
  "tags": [
      {
          "name": "ä¸º_æœ‹å‹"
      },
{
          "name": "è§†è§‰å¯ç”¨"
      }
  ]
}

```

</details>

### `__æ¶ˆæ¯__`

ä¹‹å‰æ¶ˆæ¯çš„`åˆ—è¡¨`ã€‚

è¯·å‚é˜…ä¸Šé¢`body["messages"]`çš„å€¼ã€‚


### `__èŠå¤©ID__`

èŠå¤©IDçš„`å­—ç¬¦ä¸²`ã€‚

è¯·å‚é˜…ä¸Šé¢`__metadata__["chat_id"]`çš„å€¼ã€‚

### `__ä¼šè¯ID__`

ä¼šè¯IDçš„`å­—ç¬¦ä¸²`ã€‚

è¯·å‚é˜…ä¸Šé¢`__metadata__["session_id"]`çš„å€¼ã€‚

### `__æ¶ˆæ¯ID__`

æ¶ˆæ¯IDçš„`å­—ç¬¦ä¸²`ã€‚

è¯·å‚é˜…ä¸Šé¢`__metadata__["message_id"]`çš„å€¼ã€‚

### `__äº‹ä»¶å‘å°„å™¨__`

ä¸€ä¸ª`å¯è°ƒç”¨é¡¹`ç”¨äºå‘ç”¨æˆ·æ˜¾ç¤ºäº‹ä»¶ä¿¡æ¯ã€‚

### `__äº‹ä»¶è°ƒç”¨__`

ä¸€ä¸ª`å¯è°ƒç”¨é¡¹`ç”¨äº`è¡ŒåŠ¨`ã€‚

### `__æ–‡ä»¶__`

é€šè¿‡èŠå¤©å‘é€çš„æ–‡ä»¶çš„`åˆ—è¡¨`ã€‚æ³¨æ„å›¾åƒä¸è¢«è§†ä¸ºæ–‡ä»¶ï¼Œå¹¶ç›´æ¥ä½œä¸º`body["messages"]`åˆ—è¡¨çš„ä¸€éƒ¨åˆ†å‘é€åˆ°æ¨¡å‹ã€‚

å‡ºäºæ€§èƒ½åŸå› ï¼Œæ–‡ä»¶çš„å®é™…äºŒè¿›åˆ¶å†…å®¹ä¸åŒ…å«åœ¨å‚æ•°ä¸­ï¼Œä½†æ–‡ä»¶å¯ä»¥é€šè¿‡å…¶è·¯å¾„è®¿é—®ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨`docker`çš„Pythonè¯­æ³•è·¯å¾„å¯èƒ½æ˜¯ï¼š

```python
from pathlib import Path

the_file = Path(f"/app/backend/data/uploads/{__files__[0]["files"]["id"]}_{__files__[0]["files"]["filename"]}")
assert the_file.exists()
```

æ³¨æ„ï¼Œ`files`å­—å…¸ä¹Ÿå¯ä»¥é€šè¿‡`__metadata__["files"]`è®¿é—®ï¼ˆå¦‚æœæ²¡æœ‰å‘é€æ–‡ä»¶ï¼Œå…¶å€¼ä¸º`[]`ï¼‰ï¼Œæˆ–è€…é€šè¿‡`body["files"]`è®¿é—®ï¼ˆä½†å¦‚æœæ²¡æœ‰å‘é€æ–‡ä»¶ï¼Œ`body`ä¸­æ²¡æœ‰`files`é”®ï¼‰ã€‚

<details>
<summary>ç¤ºä¾‹</summary>

```json

[
  {
    "type": "æ–‡ä»¶",
    "file": {
      "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "filename": "æ‹¿ç ´ä»‘ - ç»´åŸºç™¾ç§‘.pdf",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "hash": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
      "data": {
        "content": "æ‹¿ç ´ä»‘ - ç»´åŸºç™¾ç§‘\n\n\næ‹¿ç ´ä»‘ä¸€ä¸–\n\nã€Šçš‡å¸æ‹¿ç ´ä»‘åœ¨å·´é»æœä¼Šå‹’é‡Œå®«ä¹¦æˆ¿é‡Œã€‹ï¼Œ1812\n\næ³•å…°è¥¿çš„çš‡å¸\n\nç¬¬ä¸€ä¸ªç»Ÿæ²»æ—¶æœŸ 1804å¹´5æœˆ18æ—¥ â€“ 1814å¹´4æœˆ6æ—¥\n\nç»§ä»»è€… è·¯æ˜“åå…«[a]\n\nç¬¬äºŒä¸ªç»Ÿæ²»æ—¶æœŸ 1815å¹´3æœˆ20æ—¥Â â€“ 1815å¹´6æœˆ22æ—¥\n\nç»§ä»»è€… è·¯æ˜“åå…«[a]\n\næ³•å…°è¥¿å…±å’Œå›½çš„ç¬¬ä¸€æ‰§æ”¿\n\nåœ¨ä½\n1799å¹´12æœˆ13æ—¥Â â€“ 1804å¹´5æœˆ18æ—¥\n\nå‡ºç”Ÿæ‹¿ç ´ä»‘Â·æ³¢æ‹¿å·´\n1769å¹´8æœˆ15æ—¥\né˜¿é›…ä¹”ï¼Œç§‘è¥¿å˜‰ï¼Œæ³•å…°è¥¿ç‹å›½\n\nå»ä¸– 1821å¹´5æœˆ5æ—¥ (äº«å¹´Â 51å²)\nåœ£èµ«å‹’æ‹¿å²›çš„é¾™ä¼å¾·\n\nè‘¬ç¤¼ 1840å¹´12æœˆ15æ—¥\nå·´é»è£å†›é™¢\n\næ‹¿ç ´ä»‘\næ‹¿ç ´ä»‘Â·æ³¢æ‹¿å·´[b]ï¼ˆå‡ºç”Ÿæ—¶ä¸ºæ‹¿ç ´ä»‘Â·å¸ƒå¥¥çº³å·´å°”ï¼›[1][c] 1769å¹´8æœˆ15æ—¥ â€“ 1821å¹´5æœˆ5æ—¥ï¼‰ï¼Œåæ”¹ä¸º [REDACTED]",
        # å†…å®¹å€¼æ˜¯æ–‡æ¡£è§£æå™¨çš„è¾“å‡ºï¼Œä¸Šè¿°ç¤ºä¾‹ä½¿ç”¨Tikaä½œä¸ºæ–‡æ¡£è§£æå™¨
      },
      "meta": {
        "name": "æ‹¿ç ´ä»‘ - ç»´åŸºç™¾ç§‘.pdf",
        "content_type": "application/pdf",
        "size": 10486578,
        # ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œè¿™é‡Œå¤§çº¦10MB
        "data": {},
        "collection_name": "æ–‡ä»¶-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
        # å§‹ç»ˆä»¥æ–‡ä»¶å¼€å¤´
      },
      "created_at": 1740000000,
      "updated_at": 1740000000
    },
    "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "url": "/api/v1/files/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "name": "æ‹¿ç ´ä»‘ - ç»´åŸºç™¾ç§‘.pdf",
    "collection_name": "æ–‡ä»¶-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    "status": "å·²ä¸Šä¼ ",
    "size": 10486578,
    "error": "",
    "itemId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    # itemIdä¸file["id"]ä¸åŒ
  }
]


```

</details>

### `__è¯·æ±‚__`

ä¸€ä¸ª`fastapi.Request`å®ä¾‹ã€‚å¯ä»¥åœ¨[è¿ç§»é¡µé¢](../../features/plugin/migration/index.mdx)æˆ–[fastapiçš„æ–‡æ¡£](https://fastapi.tiangolo.com/reference/request/)ä¸­äº†è§£æ›´å¤šã€‚

### `__ä»»åŠ¡__`

`ä»»åŠ¡ç±»å‹`çš„`å­—ç¬¦ä¸²`ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å…¶å€¼åªæ˜¯`__metadata__["task"]`çš„ç®€å†™ï¼Œå¦åˆ™ä¸º`None`ã€‚

<details>
<summary>å¯èƒ½çš„å€¼</summary>

```json

[
    "æ ‡é¢˜ç”Ÿæˆ",
    "æ ‡ç­¾ç”Ÿæˆ",
    "è¡¨æƒ…ç”Ÿæˆ",
    "æŸ¥è¯¢ç”Ÿæˆ",
    "å›¾åƒæç¤ºç”Ÿæˆ",
    "è‡ªåŠ¨è¡¥å…¨ç”Ÿæˆ",
    "å‡½æ•°è°ƒç”¨",
    "MOAå“åº”ç”Ÿæˆ"
]
```

</details>

### `__ä»»åŠ¡å†…å®¹__`

ä¸€ä¸ª`å­—å…¸`ï¼ŒåŒ…å«å®Œæˆç»™å®š`__ä»»åŠ¡__`æ‰€éœ€çš„`å†…å®¹`ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å…¶å€¼åªæ˜¯`__metadata__["task_body"]`çš„ç®€å†™ï¼Œå¦åˆ™ä¸º`None`ã€‚

å…¶ç»“æ„ä¸ä¸Šé¢çš„`å†…å®¹`ç›¸åŒï¼Œå…·æœ‰ç±»ä¼¼ä½¿ç”¨åˆé€‚æ¨¡å‹å’Œç³»ç»Ÿæ¶ˆæ¯çš„ä¿®æ”¹ã€‚


### `__å·¥å…·__`

`ToolUserModel`å®ä¾‹çš„`åˆ—è¡¨`ã€‚

æœ‰å…³`ToolUserModel`å®ä¾‹å±æ€§çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥åœ¨[tools.py](https://github.com/open-webui/open-webui/blob/main/backend/open_webui/models/tools.py)æ‰¾åˆ°ä»£ç ã€‚

