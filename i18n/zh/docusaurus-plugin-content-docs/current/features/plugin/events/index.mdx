---
sidebar_position: 3
title: "â›‘ï¸ äº‹ä»¶"
---

# â›‘ï¸ äº‹ä»¶: åœ¨ Open WebUI ä¸­ä½¿ç”¨ `__event_emitter__` å’Œ `__event_call__`

Open WebUI çš„æ’ä»¶æ¶æ„ä¸ä»…ä»…æ˜¯å¤„ç†è¾“å…¥å’Œç”Ÿæˆè¾“å‡ºâ€”â€”**å®ƒæ˜¯å…³äºä¸ UI å’Œç”¨æˆ·çš„å®æ—¶äº¤äº’é€šä¿¡**ã€‚ä¸ºäº†è®©ä½ çš„å·¥å…·ã€å‡½æ•°å’Œç®¡é“æ›´åŠ åŠ¨æ€ï¼ŒOpen WebUI é€šè¿‡ `__event_emitter__` å’Œ `__event_call__` æä¾›äº†ä¸€ä¸ªå†…ç½®äº‹ä»¶ç³»ç»Ÿã€‚

æœ¬æŒ‡å—è§£é‡Šäº†**ä»€ä¹ˆæ˜¯äº‹ä»¶**ã€**å¦‚ä½•ä»ä½ çš„ä»£ç ä¸­è§¦å‘å®ƒä»¬**ä»¥åŠ**ä½ å¯ä»¥ä½¿ç”¨çš„å®Œæ•´äº‹ä»¶ç±»å‹ç›®å½•**ï¼ˆä¸åªæ˜¯ `"input"`ï¼‰ã€‚

---

## ğŸŒŠ ä»€ä¹ˆæ˜¯äº‹ä»¶ï¼Ÿ

**äº‹ä»¶**æ˜¯ä»ä½ çš„åç«¯ä»£ç ï¼ˆå·¥å…·æˆ–å‡½æ•°ï¼‰å‘é€åˆ° Web UI çš„å®æ—¶é€šçŸ¥æˆ–äº¤äº’è¯·æ±‚ã€‚å®ƒä»¬å…è®¸ä½ æ›´æ–°èŠå¤©ã€æ˜¾ç¤ºé€šçŸ¥ã€è¯·æ±‚ç¡®è®¤ã€è¿è¡Œ UI æµç¨‹ç­‰ç­‰ã€‚

- äº‹ä»¶ä½¿ç”¨ `__event_emitter__` è¾…åŠ©å‡½æ•°è¿›è¡Œå•å‘æ›´æ–°ï¼Œæˆ–è€…å½“ä½ éœ€è¦ç”¨æˆ·è¾“å…¥æˆ–å“åº”ï¼ˆä¾‹å¦‚ç¡®è®¤ã€è¾“å…¥ç­‰ï¼‰æ—¶ä½¿ç”¨ `__event_call__`ã€‚

**æ¯”å–»ï¼š**
å°†äº‹ä»¶æƒ³è±¡æˆä½ çš„æ’ä»¶å¯ä»¥è§¦å‘çš„æ¨é€é€šçŸ¥å’Œæ¨¡æ€å¯¹è¯æ¡†ï¼Œä½¿èŠå¤©ä½“éªŒæ›´åŠ ä¸°å¯Œå’Œäº’åŠ¨ã€‚

---

## ğŸ§° åŸºæœ¬ç”¨æ³•

### å‘é€äº‹ä»¶

ä½ å¯ä»¥åœ¨å·¥å…·æˆ–å‡½æ•°ä¸­çš„ä»»æ„ä½ç½®é€šè¿‡è°ƒç”¨ä»¥ä¸‹æ–¹å¼è§¦å‘äº‹ä»¶ï¼š

```python
await __event_emitter__(
    {
        "type": "status",  # å‚è§ä¸‹é¢çš„äº‹ä»¶ç±»å‹åˆ—è¡¨
        "data": {
            "description": "å¤„ç†å¼€å§‹ï¼",
            "done": False,
            "hidden": False,
        },
    }
)
```

ä½ **ä¸éœ€è¦**æ‰‹åŠ¨æ·»åŠ è¯¸å¦‚ `chat_id` æˆ– `message_id` çš„å­—æ®µâ€”â€”è¿™äº›ç”± Open WebUI è‡ªåŠ¨å¤„ç†ã€‚

### äº¤äº’å¼äº‹ä»¶

å½“ä½ éœ€è¦æš‚åœæ‰§è¡Œç›´åˆ°ç”¨æˆ·å“åº”ï¼ˆä¾‹å¦‚ç¡®è®¤/å–æ¶ˆå¯¹è¯æ¡†ã€ä»£ç æ‰§è¡Œæˆ–è¾“å…¥ï¼‰æ—¶ï¼Œè¯·ä½¿ç”¨ `__event_call__`ï¼š

```python
result = await __event_call__(
    {
        "type": "input",  # æˆ– "confirmation", "execute"
        "data": {
            "title": "è¯·è¾“å…¥ä½ çš„å¯†ç ",
            "message": "æ­¤æ“ä½œéœ€è¦å¯†ç ",
            "placeholder": "åœ¨æ­¤è¾“å…¥ä½ çš„å¯†ç ",
        },
    }
)
# result å°†åŒ…å«ç”¨æˆ·çš„è¾“å…¥å€¼
```

---

## ğŸ“œ äº‹ä»¶è´Ÿè½½ç»“æ„

å½“ä½ å‘é€æˆ–è°ƒç”¨äº‹ä»¶æ—¶ï¼Œå…¶åŸºæœ¬ç»“æ„ä¸ºï¼š

```json
{
  "type": "event_type",   // å‚è§ä¸‹é¢çš„å®Œæ•´åˆ—è¡¨
  "data": { ... }         // äº‹ä»¶ç‰¹å®šçš„è´Ÿè½½
}
```

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ åªéœ€è®¾ç½® `"type"` å’Œ `"data"`ã€‚Open WebUI ä¼šè‡ªåŠ¨å®Œæˆè·¯ç”±ã€‚

---

## ğŸ—‚ äº‹ä»¶ç±»å‹å®Œæ•´åˆ—è¡¨

ä»¥ä¸‹æ˜¯**æ‰€æœ‰å—æ”¯æŒçš„ `type` å€¼**çš„ç»¼åˆè¡¨æ ¼ï¼ŒåŒ…æ‹¬å®ƒä»¬çš„é¢„æœŸç”¨é€”å’Œæ•°æ®ç»“æ„ã€‚ï¼ˆåŸºäºå¯¹ Open WebUI äº‹ä»¶å¤„ç†é€»è¾‘çš„æœ€æ–°åˆ†æã€‚ï¼‰

| ç±»å‹                        | ä½¿ç”¨åœºæ™¯                                   | æ•°æ®è´Ÿè½½ç»“æ„ï¼ˆç¤ºä¾‹ï¼‰                                  |
|-----------------------------|-------------------------------------------|----------------------------------------------------|
| `status`                    | æ˜¾ç¤ºæ¶ˆæ¯çš„çŠ¶æ€æ›´æ–°/å†å²è®°å½•                                | `{description: ..., done: bool, hidden: bool}`                     |
| `chat:completion`           | æä¾›èŠå¤©å®Œæˆç»“æœ                                    | ï¼ˆè‡ªå®šä¹‰ï¼Œå‚è§ Open WebUI å†…éƒ¨ï¼‰                                 |
| `chat:message:delta`,<br/>`message` | å‘å½“å‰æ¶ˆæ¯è¿½åŠ å†…å®¹                              | `{content: "è¦è¿½åŠ çš„æ–‡æœ¬"}`                                      |
| `chat:message`,<br/>`replace`        | å®Œå…¨æ›¿æ¢å½“å‰æ¶ˆæ¯å†…å®¹                                  | `{content: "æ›¿æ¢æ–‡æœ¬"}`                                    |
| `chat:message:files`,<br/>`files`   | è®¾ç½®æˆ–è¦†ç›–æ¶ˆæ¯æ–‡ä»¶ï¼ˆç”¨äºä¸Šä¼ ã€è¾“å‡ºï¼‰                     | `{files: [...]}`                                                   |
| `chat:title`                | è®¾ç½®ï¼ˆæˆ–æ›´æ–°ï¼‰èŠå¤©ä¼šè¯æ ‡é¢˜                              | ä¸»é¢˜å­—ç¬¦ä¸²æˆ– `{title: ...}`                                     |
| `chat:tags`                 | æ›´æ–°èŠå¤©çš„æ ‡ç­¾é›†åˆ                                | æ ‡ç­¾æ•°ç»„æˆ–å¯¹è±¡                                                |
| `source`,<br/>`citation`              | æ·»åŠ æ¥æº/å¼•ç”¨æˆ–ä»£ç æ‰§è¡Œç»“æœ                            | å¯¹äºä»£ç ï¼šå‚è§[ä¸‹é¢çš„å†…å®¹ã€‚](#code-execution-event)                      |
| `notification`              | åœ¨ UI ä¸­æ˜¾ç¤ºé€šçŸ¥ï¼ˆ"toast"ï¼‰                       | `{type: "info" æˆ– "success" æˆ– "error" æˆ– "warning", content: "..."}`      |
| `confirmation` <br/>(éœ€è¦ `__event_call__`) | è¯¢é—®ç¡®è®¤ï¼ˆç¡®å®š/å–æ¶ˆå¯¹è¯æ¡†ï¼‰                        | `{title: "...", message: "..."}`                                   |
| `input` <br/>(éœ€è¦ `__event_call__`)    | è¯·æ±‚ç®€å•çš„ç”¨æˆ·è¾“å…¥ï¼ˆ"è¾“å…¥æ¡†"å¯¹è¯æ¡†ï¼‰                   | `{title: "...", message: "...", placeholder: "...", value: ...}`   |
| `execute` <br/>(éœ€è¦ `__event_call__`)  | è¯·æ±‚æ‰§è¡Œç”¨æˆ·ç«¯ä»£ç å¹¶è¿”å›ç»“æœ  | `{code: "...javascript code..."}`                                  |

**å…¶ä»–/é«˜çº§ç±»å‹ï¼š**

- æ‚¨å¯ä»¥å®šä¹‰è‡ªå·±çš„ç±»å‹å¹¶åœ¨UIå±‚å¤„ç†ä¸­ä½¿ç”¨å®ƒä»¬ï¼ˆæˆ–ä½¿ç”¨å³å°†æ¨å‡ºçš„äº‹ä»¶æ‰©å±•æœºåˆ¶ï¼‰ã€‚

### â— ç‰¹å®šäº‹ä»¶ç±»å‹çš„è¯¦ç»†ä¿¡æ¯
### `status`

åœ¨UIä¸­æ˜¾ç¤ºçŠ¶æ€/è¿›åº¦æ›´æ–°ï¼š

```python
await __event_emitter__(
    {
        "type": "status",
        "data": {
            "description": "æ­¥éª¤ 1/3: æ­£åœ¨è·å–æ•°æ®...",
            "done": False,
            "hidden": False,
        },
    }
)
```

---

### `chat:message:delta` æˆ– `message`

**æµå¼è¾“å‡º**ï¼ˆè¿½åŠ æ–‡æœ¬ï¼‰ï¼š

```python
await __event_emitter__(
    {
        "type": "chat:message:delta",  # æˆ–ç®€å•åœ° "message"
        "data": {
            "content": "éƒ¨åˆ†æ–‡æœ¬, "
        },
    }
)

# éšåï¼Œå½“ç”Ÿæˆæ›´å¤šæ—¶ï¼š
await __event_emitter__(
    {
        "type": "chat:message:delta",
        "data": {
            "content": "ä¸‹ä¸€æ®µå“åº”å†…å®¹ã€‚"
        },
    }
)
```

---

### `chat:message` æˆ– `replace`

**è®¾ç½®ï¼ˆæˆ–æ›¿æ¢ï¼‰æ•´ä¸ªæ¶ˆæ¯å†…å®¹ï¼š**

```python
await __event_emitter__(
    {
        "type": "chat:message",  # æˆ– "replace"
        "data": {
            "content": "æœ€ç»ˆå®Œæ•´çš„å“åº”å†…å®¹ã€‚"
        },
    }
)
```

---

### `files` æˆ– `chat:message:files`

**é™„åŠ æˆ–æ›´æ–°æ–‡ä»¶ï¼š**

```python
await __event_emitter__(
    {
        "type": "files",  # æˆ– "chat:message:files"
        "data": {
            "files": [
               # Open WebUI æ–‡ä»¶å¯¹è±¡
            ]
        },
    }
)
```

---

### `chat:title`

**æ›´æ–°èŠå¤©çš„æ ‡é¢˜ï¼š**

```python
await __event_emitter__(
    {
        "type": "chat:title",
        "data": {
            "title": "å¸‚åœºåˆ†ææœºå™¨äººä¼šè¯"
        },
    }
)
```

---

### `chat:tags`

**æ›´æ–°èŠå¤©çš„æ ‡ç­¾ï¼š**

```python
await __event_emitter__(
    {
        "type": "chat:tags",
        "data": {
            "tags": ["é‡‘è", "AI", "æ¯æ—¥æŠ¥å‘Š"]
        },
    }
)
```

---

### `source` æˆ– `citation`ï¼ˆä»¥åŠä»£ç æ‰§è¡Œï¼‰

**æ·»åŠ å‚è€ƒ/å¼•ç”¨ï¼š**

```python
await __event_emitter__(
    {
        "type": "source",  # æˆ– "citation"
        "data": {
            # Open WebUI æ¥æºï¼ˆå¼•ç”¨ï¼‰å¯¹è±¡
        }
    }
)
```

**é’ˆå¯¹ä»£ç æ‰§è¡Œï¼ˆè·Ÿè¸ªæ‰§è¡ŒçŠ¶æ€ï¼‰ï¼š**

```python
await __event_emitter__(
    {
        "type": "source",
        "data": {
            # Open WebUI ä»£ç æ¥æºï¼ˆå¼•ç”¨ï¼‰å¯¹è±¡
        }
    }
)
```

---

### `notification`

**æ˜¾ç¤ºä¸€ä¸ªæç¤ºé€šçŸ¥ï¼š**

```python
await __event_emitter__(
    {
        "type": "notification",
        "data": {
            "type": "info",  # "success", "warning", "error"
            "content": "æ“ä½œå·²æˆåŠŸå®Œæˆï¼"
        }
    }
)
```

---

### `confirmation`ï¼ˆ**éœ€è¦** `__event_call__`ï¼‰

**æ˜¾ç¤ºä¸€ä¸ªç¡®è®¤å¯¹è¯æ¡†å¹¶è·å–ç”¨æˆ·å“åº”ï¼š**

```python
result = await __event_call__(
    {
        "type": "confirmation",
        "data": {
            "title": "æ‚¨ç¡®å®šå—ï¼Ÿ",
            "message": "æ‚¨çœŸçš„æƒ³ç»§ç»­å—ï¼Ÿ"
        }
    }
)

if result:  # æˆ–æ£€æŸ¥ç»“æœå†…å®¹
    await __event_emitter__({
        "type": "notification",
        "data": {"type": "success", "content": "ç”¨æˆ·ç¡®è®¤äº†æ“ä½œã€‚"}
    })
else:
    await __event_emitter__({
        "type": "notification",
        "data": {"type": "warning", "content": "ç”¨æˆ·å–æ¶ˆäº†æ“ä½œã€‚"}
    })
```

---

### `input`ï¼ˆ**éœ€è¦** `__event_call__`ï¼‰

**æç¤ºç”¨æˆ·è¾“å…¥æ–‡æœ¬ï¼š**

```python
result = await __event_call__(
    {
        "type": "input",
        "data": {
            "title": "è¯·è¾“å…¥æ‚¨çš„å§“å",
            "message": "æˆ‘ä»¬éœ€è¦æ‚¨çš„å§“åä»¥ç»§ç»­ã€‚",
            "placeholder": "æ‚¨çš„å…¨å"
        }
    }
)

user_input = result
await __event_emitter__(
    {
        "type": "notification",
        "data": {"type": "info", "content": f"æ‚¨è¾“å…¥çš„æ˜¯ï¼š{user_input}"}
    }
)
```

---

### `execute`ï¼ˆ**éœ€è¦** `__event_call__`ï¼‰

**åœ¨ç”¨æˆ·ç«¯åŠ¨æ€è¿è¡Œä»£ç ï¼š**

```python
result = await __event_call__(
    {
        "type": "execute",
        "data": {
            "code": "print(40 + 2);",
        }
    }
)

await __event_emitter__(
    {
        "type": "notification",
        "data": {
            "type": "info",
            "content": f"ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œç»“æœï¼š{result}"
        }
    }
)
```

---

## ğŸ—ï¸ ä½•æ—¶åŠä½•å¤„ä½¿ç”¨äº‹ä»¶

- **ä»Open WebUIä¸­çš„ä»»ä½•å·¥å…·æˆ–å‡½æ•°è°ƒç”¨ã€‚**
- ç”¨äº**æµå¼å“åº”**ã€æ˜¾ç¤ºè¿›åº¦ã€è¯·æ±‚ç”¨æˆ·æ•°æ®ã€æ›´æ–°ç•Œé¢æˆ–æ˜¾ç¤ºè¡¥å……ä¿¡æ¯/æ–‡ä»¶ã€‚
- `await __event_emitter__` ç”¨äºå•å‘æ¶ˆæ¯ï¼ˆå‘é€åå³å¿˜ï¼‰ã€‚
- `await __event_call__` åˆ™ç”¨äºéœ€è¦ç”¨æˆ·å“åº”æ—¶ï¼ˆè¾“å…¥ã€æ‰§è¡Œã€ç¡®è®¤ï¼‰ã€‚

---

## ğŸ’¡ æç¤ºå’Œé«˜çº§è¯´æ˜

- **æ¯æ¡æ¶ˆæ¯æ”¯æŒå¤šç§ç±»å‹ï¼š** æ‚¨å¯ä»¥ä¸ºä¸€æ¡æ¶ˆæ¯å‘å‡ºä¸åŒç±»å‹çš„å¤šä¸ªäº‹ä»¶ï¼Œä¾‹å¦‚ï¼Œå…ˆæ˜¾ç¤º `status` çŠ¶æ€æ›´æ–°ï¼Œå†ç”¨ `chat:message:delta` æµå¼ä¼ è¾“ï¼Œæœ€åç”¨ `chat:message` å®Œæˆã€‚
- **è‡ªå®šä¹‰äº‹ä»¶ç±»å‹ï¼š** è™½ç„¶ä¸Šè¿°åˆ—è¡¨ä¸ºæ ‡å‡†ç±»å‹ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç±»å‹ï¼Œå¹¶åœ¨è‡ªå®šä¹‰UIä»£ç ä¸­æ£€æµ‹/å¤„ç†å®ƒä»¬ã€‚
- **å¯æ‰©å±•æ€§ï¼š** äº‹ä»¶ç³»ç»Ÿæ—¨åœ¨ä¸æ–­å‘å±•â€”â€”è¯·å§‹ç»ˆæŸ¥çœ‹ [Open WebUI æ–‡æ¡£](https://github.com/open-webui/open-webui) ä»¥è·å–æœ€æ–°åˆ—è¡¨å’Œé«˜çº§ç”¨æ³•ã€‚

---

## ğŸ§ å¸¸è§é—®é¢˜

### é—®ï¼šå¦‚ä½•å‘ç”¨æˆ·è§¦å‘ä¸€ä¸ªé€šçŸ¥ï¼Ÿ
ä½¿ç”¨ `notification` ç±»å‹ï¼š
```python
await __event_emitter__({
    "type": "notification",
    "data": {"type": "success", "content": "ä»»åŠ¡å®Œæˆ"}
})
```

### é—®ï¼šå¦‚ä½•æç¤ºç”¨æˆ·è¾“å…¥å¹¶è·å–ä»–ä»¬çš„å›ç­”ï¼Ÿ
ä½¿ç”¨ï¼š
```python
response = await __event_call__({
    "type": "input",
    "data": {
        "title": "æ‚¨çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ",
        "message": "è¯·è¾“å…¥æ‚¨å–œæ¬¢çš„åå­—ï¼š",
        "placeholder": "åå­—"
    }
})
# response å°†æ˜¯ï¼š{"value": "ç”¨æˆ·çš„å›ç­”"}
```

### é—®ï¼š`__event_call__` æœ‰å“ªäº›å¯ç”¨äº‹ä»¶ç±»å‹ï¼Ÿ
- `"input"`ï¼šè¾“å…¥æ¡†å¯¹è¯æ¡†
- `"confirmation"`ï¼šæ˜¯/å¦ã€ç¡®å®š/å–æ¶ˆå¯¹è¯æ¡†
- `"execute"`ï¼šåœ¨å®¢æˆ·ç«¯æ‰§è¡Œæä¾›çš„ä»£ç å¹¶è¿”å›ç»“æœ

### é—®ï¼šå¯ä»¥æ›´æ–°é™„åŠ åˆ°æ¶ˆæ¯çš„æ–‡ä»¶å—ï¼Ÿ
å¯ä»¥â€”â€”ä½¿ç”¨ `"files"` æˆ– `"chat:message:files"` äº‹ä»¶ç±»å‹ï¼Œå¹¶é™„å¸¦ `{files: [...]}` æ•°æ®ã€‚

### é—®ï¼šå¯ä»¥æ›´æ–°å¯¹è¯æ ‡é¢˜æˆ–æ ‡ç­¾å—ï¼Ÿ
å½“ç„¶å¯ä»¥ï¼šåˆ†åˆ«ä½¿ç”¨ `"chat:title"` æˆ– `"chat:tags"`ã€‚

### é—®ï¼šå¯ä»¥å‘ç”¨æˆ·æµå¼ä¼ è¾“å“åº”ï¼ˆéƒ¨åˆ†ä»¤ç‰Œï¼‰å—ï¼Ÿ
å¯ä»¥â€”â€”åœ¨å¾ªç¯ä¸­å‘å‡º `"chat:message:delta"` äº‹ä»¶ï¼Œæœ€åä½¿ç”¨ `"chat:message"` å®Œæˆã€‚

---

## ğŸ“ ç»“è®º

**äº‹ä»¶** è®©æ‚¨åœ¨ Open WebUI ä¸­æ‹¥æœ‰å®æ—¶äº¤äº’çš„è¶…èƒ½åŠ›ã€‚å®ƒä»¬è®©æ‚¨çš„ä»£ç èƒ½å¤Ÿæ›´æ–°å†…å®¹ã€è§¦å‘é€šçŸ¥ã€è¯·æ±‚ç”¨æˆ·è¾“å…¥ã€æµå¼ä¼ è¾“ç»“æœã€å¤„ç†ä»£ç ç­‰åŠŸèƒ½â€”â€”å°†æ‚¨çš„åç«¯æ™ºèƒ½æ— ç¼åµŒå…¥èŠå¤© UIã€‚

- ä½¿ç”¨ `__event_emitter__` è¿›è¡Œå•å‘çŠ¶æ€/å†…å®¹æ›´æ–°ã€‚
- ä½¿ç”¨ `__event_call__` å¤„ç†éœ€è¦ç”¨æˆ·åç»­æ“ä½œçš„äº¤äº’ï¼ˆè¾“å…¥ã€ç¡®è®¤ã€æ‰§è¡Œï¼‰ã€‚

å‚è€ƒæ­¤æ–‡æ¡£äº†è§£å¸¸è§äº‹ä»¶ç±»å‹å’Œç»“æ„ï¼Œæ¢ç´¢ Open WebUI æºä»£ç æˆ–æ–‡æ¡£ä»¥è·å–æœ€æ–°æ›´æ–°æˆ–è‡ªå®šä¹‰äº‹ä»¶ï¼

---

**ç¥æ‚¨åœ¨ Open WebUI ä¸­è¿›è¡Œäº‹ä»¶é©±åŠ¨ç¼–ç¨‹æ„‰å¿«ï¼ğŸš€**