---
sidebar_position: 20
title: "ğŸ’¡ ç‰¹æ®Šãªå¼•æ•°"
---

:::warning
ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«ã‚ˆã‚‹å¯„ç¨¿ã§ã‚ã‚Šã€Open WebUIãƒãƒ¼ãƒ ã«ã‚ˆã‚‹ã‚µãƒãƒ¼ãƒˆã¯æä¾›ã•ã‚Œã¾ã›ã‚“ã€‚ç‰¹å®šã®ç”¨é€”ã«å‘ã‘ã¦Open WebUIã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹æ–¹æ³•ã‚’ç¤ºã™ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚å¯„ç¨¿ã‚’ã”å¸Œæœ›ã§ã™ã‹ï¼Ÿå¯„ç¨¿ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ã”è¦§ãã ã•ã„ã€‚
:::

# ğŸ’¡ ç‰¹æ®Šãªå¼•æ•°

ç‹¬è‡ªã®`Tools`ã€`Functions`ï¼ˆ`Filters`ã€`Pipes`ã¾ãŸã¯`Actions`ï¼‰ã€`Pipelines`ãªã©ã‚’é–‹ç™ºã™ã‚‹éš›ã«ã€ç‰¹æ®Šãªå¼•æ•°ã‚’ä½¿ç”¨ã—ã¦Open-WebUIãŒæä¾›ã™ã‚‹å¤šæ§˜ãªæ©Ÿèƒ½ã‚’æ´»ç”¨ã§ãã¾ã™ã€‚

ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€å„ç‰¹æ®Šãªå¼•æ•°ã®å‹ã¨æ§‹é€ ã‚’è©³è¿°ã—ã€ä¾‹ã‚’æä¾›ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã¾ã™ã€‚

### `body`

`dict`å½¢å¼ã§ã€é€šå¸¸ã¯ã»ã¼ç›´æ¥ãƒ¢ãƒ‡ãƒ«ã«é€ã‚‰ã‚Œã¾ã™ã€‚å³å¯†ã«ã¯ç‰¹æ®Šãªå¼•æ•°ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€å‚ç…§ã‚’å®¹æ˜“ã«ã™ã‚‹ãŸã‚ã«ã“ã“ã«å«ã‚ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€å†…éƒ¨ã«ã¯ã„ãã¤ã‹ã®ç‰¹æ®Šãªå¼•æ•°ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

<details>
<summary>ä¾‹</summary>

```json

{
  "stream": true,
  "model": "my-cool-model",
  # å°æ–‡å­—ã®æ–‡å­—åˆ—ã§å˜èªã‚’ãƒã‚¤ãƒ•ãƒ³ã§åŒºåˆ‡ã£ãŸå½¢å¼ï¼šã“ã‚Œã¯ãƒ¢ãƒ‡ãƒ«ã®IDã§ã™
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "ã“ã®ç”»åƒã«ã¯ä½•ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿ"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdYAAAGcCAYAAABk2YF[REDACTED]"
            # ç”»åƒã¯base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã•ã‚Œã¾ã™
          }
        }
      ]
    },
    {
      "role": "assistant",
      "content": "ç”»åƒã«ã¯[REDACTED]ã®ã‚ˆã†ã§ã™"
    },
  ],
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "stream_options": {
    "include_usage": true
  },
  "metadata": "[__metadata__ã¨å®Œå…¨ã«åŒã˜dict]",
  "files": "[__files__ã¨å®Œå…¨ã«åŒã˜ãƒªã‚¹ãƒˆ]"
}


```

</details>

### `__user__`

`dict`å½¢å¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å«ã‚€ã€‚

`UserValves`ã‚¯ãƒ©ã‚¹ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹å ´åˆã€ãã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã¯`__user__["valves"]`ã‚’ä»‹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã‚Œä»¥å¤–ã§ã¯ã€`valves`ã®ã‚­ãƒ¼å€¤ã¯`__user__`å†…ã«å®Œå…¨ã«æ¬ è½ã—ã¾ã™ã€‚

<details>
<summary>ä¾‹</summary>

```json
{
  "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "email": "cheesy_dude@openwebui.com",
  "name": "ãƒ‘ãƒˆãƒªãƒƒã‚¯",
  "role": "user",
  # roleã¯`user`ã€`admin`ã®ã„ãšã‚Œã‹ã«ãªã‚Šã¾ã™
  "valves": "[UserValveã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹]"
}
```

</details>

### `__metadata__`

ãƒãƒ£ãƒƒãƒˆã€ãƒ¢ãƒ‡ãƒ«ã€ãƒ•ã‚¡ã‚¤ãƒ«ãªã©ã«é–¢ã™ã‚‹åºƒç¯„ãªæƒ…å ±ã‚’å«ã‚€`dict`ã€‚

<details>
<summary>ä¾‹</summary>

```json
{
  "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "chat_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "message_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "session_id": "xxxxxxxxxxxxxxxxxxxx",
  "tool_ids": null,
  # tool_idsã¯æ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆã§ã™ã€‚
  "tool_servers": [],
  "files": "[body[files]ã¨åŒã˜å†…å®¹]",
  # ãƒ•ã‚¡ã‚¤ãƒ«ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã€filesã‚­ãƒ¼ã¯__metadata__ã«å­˜åœ¨ã—ãã®å€¤ã¯[]ã«ãªã‚Šã¾ã™
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "variables": {
    "{{USER_NAME}}": "cheesy_username",
    "{{USER_LOCATION}}": "ä¸æ˜",
    "{{CURRENT_DATETIME}}": "2025-02-02 XX:XX:XX",
    "{{CURRENT_DATE}}": "2025-02-02",
    "{{CURRENT_TIME}}": "XX:XX:XX",
    "{{CURRENT_WEEKDAY}}": "æœˆæ›œæ—¥",
    "{{CURRENT_TIMEZONE}}": "ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘/ãƒ™ãƒ«ãƒªãƒ³",
    "{{USER_LANGUAGE}}": "en-US"
  },
  "model": "[__model__ã¨åŒã˜å†…å®¹]",
  "direct": false,
  "function_calling": "ãƒã‚¤ãƒ†ã‚£ãƒ–",
  "type": "user_response",
  "interface": "open-webui"
}

```

</details>

### `__model__`

ãƒ¢ãƒ‡ãƒ«ã«é–¢ã™ã‚‹æƒ…å ±ã‚’å«ã‚€`dict`ã€‚

<details>
<summary>ä¾‹</summary>

```json
{
  "id": "my-cool-model",
  "name": "ãƒã‚¤ãƒ»ã‚¯ãƒ¼ãƒ«ãƒ»ãƒ¢ãƒ‡ãƒ«",
  "object": "model",
  "created": 1746000000,
  "owned_by": "openai",
  # openaiã¾ãŸã¯ollamaã®ã„ãšã‚Œã‹
  "info": {
      "id": "my-cool-model",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "base_model_id": "gpt-4o",
      # ãƒ¢ãƒ‡ãƒ«ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãŒæä¾›ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã®åå‰
      "name": "ãƒã‚¤ãƒ»ã‚¯ãƒ¼ãƒ«ãƒ»ãƒ¢ãƒ‡ãƒ«",
      "params": {
      "system": "ã‚ãªãŸã¯ç§ã®æœ€é«˜ã®ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚è³ªå•ã«å¯¾ã—ã¦[REDACTED]ã‚’å›ç­”ã—ã¾ã™",
      "function_calling": "ãƒã‚¤ãƒ†ã‚£ãƒ–"
      # ã‚«ã‚¹ã‚¿ãƒ ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ä¾‹ï¼š"Top K"
      },
      "meta": {
      "profile_image_url": "/static/favicon.png",
      "description": "my-cool-modelã®èª¬æ˜",
      "capabilities": {
          "vision": true,
          "usage": true,
          "citations": true
      },
      "position": 17,
      "tags": [
          {
          "name": "for_friends"
          },
          {
          "name": "vision_enabled"
          }
      ],
      "suggestion_prompts": null
      },
      "access_control": {
      "read": {
          "group_ids": [],
          "user_ids": []
      },
      "write": {
          "group_ids": [],
          "user_ids": []
      }
      },
      "is_active": true,
      "updated_at": 1740000000,
      "created_at": 1740000000
  },
  "preset": true,
  "actions": [],
  "tags": [
      {
          "name": "for_friends"
      },
{
          "name": "vision_enabled"
      }
  ]
}

```

</details>

### `__messages__`

ä»¥å‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®`list`ã€‚

ä¸Šè¨˜ã®`body["messages"]`ã®å€¤ã‚’å‚ç…§ã€‚


### `__chat_id__`

`chat_id`ã®æ–‡å­—åˆ—ã€‚

ä¸Šè¨˜ã®`__metadata__["chat_id"]`ã®å€¤ã‚’å‚ç…§ã€‚

### `__session_id__`

`session_id`ã®æ–‡å­—åˆ—ã€‚

ä¸Šè¨˜ã®`__metadata__["session_id"]`ã®å€¤ã‚’å‚ç…§ã€‚

### `__message_id__`

`message_id`ã®æ–‡å­—åˆ—ã€‚

ä¸Šè¨˜ã®`__metadata__["message_id"]`ã®å€¤ã‚’å‚ç…§ã€‚

### `__event_emitter__`

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã‚‹`Callable`ã€‚

### `__event_call__`

`Actions`ã«ä½¿ç”¨ã•ã‚Œã‚‹`Callable`ã€‚

### `__files__`

ãƒãƒ£ãƒƒãƒˆã§é€ä¿¡ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã®`list`ã€‚ç”»åƒã¯ãƒ•ã‚¡ã‚¤ãƒ«ã¨è¦‹ãªã•ã‚Œãšã€`body["messages"]`ãƒªã‚¹ãƒˆã®ä¸€éƒ¨ã¨ã—ã¦ç›´æ¥ãƒ¢ãƒ‡ãƒ«ã«é€ä¿¡ã•ã‚Œã¾ã™ã€‚

ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ä¸Šã®ç†ç”±ã‹ã‚‰ã€å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚¤ãƒŠãƒªã¯å¼•æ•°ã®ä¸€éƒ¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€å¿…è¦ã«å¿œã˜ã¦ãã®ãƒ‘ã‚¹ã‚’ä½¿ç”¨ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚ä¾‹ãˆã°`docker`ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€Pythonã®æ§‹æ–‡ã¯æ¬¡ã®é€šã‚Šã§ã™:

```python
from pathlib import Path

the_file = Path(f"/app/backend/data/uploads/{__files__[0]["files"]["id"]}_{__files__[0]["files"]["filename"]}")
assert the_file.exists()
```

åŒã˜`files` dictã¯ã€`__metadata__["files"]` (ãƒ•ã‚¡ã‚¤ãƒ«ãŒé€ä¿¡ã•ã‚Œã¦ã„ãªã„å ´åˆã€ãã®å€¤ã¯`[]`) ã¾ãŸã¯`body["files"]` (ãƒ•ã‚¡ã‚¤ãƒ«ãŒé€ä¿¡ã•ã‚Œã¦ã„ãªã„å ´åˆã€`body`ã«`files`ã‚­ãƒ¼ãŒã¾ã£ãŸãå­˜åœ¨ã—ãªã„) ã‚’ä»‹ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

<details>
<summary>ä¾‹</summary>

```json

[
  {
    "type": "file",
    "file": {
      "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "filename": "Napoleon - Wikipedia.pdf",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "hash": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
      "data": {
        "content": "Napoleon - Wikipedia\n\n\nNapoleon I\n\nThe Emperor Napoleon in His Study at the\nTuileries, 1812\n\nEmperor of the French\n\n1st reign 18 May 1804 â€“ 6 April 1814\n\nSuccessor Louis XVIII[a]\n\n2nd reign 20 March 1815Â â€“ 22Â June 1815\n\nSuccessor Louis XVIII[a]\n\nFirst Consul of the French Republic\n\nIn office\n13 December 1799Â â€“ 18 May 1804\n\nBorn Napoleone Buonaparte\n15 August 1769\nAjaccio, Corsica, Kingdom of\nFrance\n\nDied 5 May 1821 (agedÂ 51)\nLongwood, Saint Helena\n\nBurial 15 December 1840\nLes Invalides, Paris\n\nNapoleon\nNapoleon Bonaparte[b] (born Napoleone\nBuonaparte;[1][c] 15 August 1769 â€“ 5 May 1821), later\nknown [REDACTED]",
        # ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å€¤ã¯æ–‡æ›¸ãƒ‘ãƒ¼ã‚µãƒ¼ã®å‡ºåŠ›ã§ã‚ã‚Šã€ä¸Šè¨˜ã®ä¾‹ã§ã¯Tikaã‚’æ–‡æ›¸ãƒ‘ãƒ¼ã‚µãƒ¼ã¨ã—ã¦ä½¿ç”¨ã—ã¦ã„ã¾ã™
      },
      "meta": {
        "name": "Napoleon - Wikipedia.pdf",
        "content_type": "application/pdf",
        "size": 10486578,
        # ãƒã‚¤ãƒˆæ•°ã€‚ã“ã“ã§ã¯ç´„10MB
        "data": {},
        "collection_name": "file-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
        # å¸¸ã«fileã§å§‹ã¾ã‚Šã¾ã™
      },
      "created_at": 1740000000,
      "updated_at": 1740000000
    },
    "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "url": "/api/v1/files/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "name": "Napoleon - Wikipedia.pdf",
    "collection_name": "file-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    "status": "uploaded",
    "size": 10486578,
    "error": "",
    "itemId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    # itemIdã¯file["id"]ã¨ã¯ç•°ãªã‚Šã¾ã™
  }
]


```

</details>

### `__request__`

`fastapi.Request`ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã€‚è©³ã—ãã¯[ç§»è¡Œãƒšãƒ¼ã‚¸](../../features/plugin/migration/index.mdx)ã¾ãŸã¯[fastapiã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://fastapi.tiangolo.com/reference/request/)ã‚’å‚ç…§ã€‚

### `__task__`

ã‚¿ã‚¹ã‚¯ã®ç¨®é¡ã‚’ç¤ºã™`str`ã€‚ãã®å€¤ã¯ã€`__metadata__["task"]`ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãã®ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã€ãã‚Œä»¥å¤–ã®å ´åˆã¯`None`ã€‚

<details>
<summary>å¯èƒ½ãªå€¤</summary>

```json

[
    "title_generation",
    "tags_generation",
    "emoji_generation",
    "query_generation",
    "image_prompt_generation",
    "autocomplete_generation",
    "function_calling",
    "moa_response_generation"
]
```

</details>

### `__task_body__`

æŒ‡å®šã•ã‚ŒãŸ`__task__`ã‚’é”æˆã™ã‚‹ãŸã‚ã«å¿…è¦ãª`body`ã‚’å«ã‚€`dict`ã€‚ãã®å€¤ã¯ã€å­˜åœ¨ã™ã‚‹å ´åˆã¯`__metadata__["task_body"]`ã®ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã€ãã‚Œä»¥å¤–ã®å ´åˆã¯`None`ã€‚

ãã®æ§‹é€ ã¯ä¸Šè¨˜ã®`body`ã¨åŒã˜ã§ã€é©åˆ‡ãªãƒ¢ãƒ‡ãƒ«ã‚„ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç­‰ã‚’ä½¿ç”¨ã™ã‚‹ãªã©ã®ä¿®æ­£ãŒåŠ ãˆã‚‰ã‚Œã¦ã„ã¾ã™ã€‚


### `__tools__`

`ToolUserModel`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®`list`ã€‚

`ToolUserModel`ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®å±æ€§ã®è©³ç´°ã«ã¤ã„ã¦ã¯ã€ã‚³ãƒ¼ãƒ‰ã¯ [tools.py](https://github.com/open-webui/open-webui/blob/main/backend/open_webui/models/tools.py) ã«ã‚ã‚Šã¾ã™ã€‚

