---
sidebar_position: 20
title: "üí° Arguments Sp√©ciaux"
---

:::warning
Ce tutoriel est une contribution de la communaut√© et n'est pas pris en charge par l'√©quipe Open WebUI. Il sert uniquement de d√©monstration sur la fa√ßon de personnaliser Open WebUI pour votre cas d'utilisation sp√©cifique. Vous voulez contribuer ? Consultez le tutoriel de contribution.
:::

# üí° Arguments Sp√©ciaux

Lors du d√©veloppement de vos propres `Outils`, `Fonctions` (`Filtres`, `Pipes` ou `Actions`), `Pipelines`, etc., vous pouvez utiliser des arguments sp√©ciaux pour explorer tout ce qu'Open-WebUI a √† offrir.

Cette page vise √† d√©tailler le type et la structure de chaque argument sp√©cial ainsi qu'√† fournir un exemple.

### `body`

Un `dictionnaire` g√©n√©ralement destin√© √† √™tre transmis presque directement au mod√®le. Bien qu'il ne s'agisse pas strictement d'un argument sp√©cial, il est inclus ici pour une r√©f√©rence plus facile et parce qu'il contient lui-m√™me des arguments sp√©ciaux.

<details>
<summary>Exemple</summary>

```json

{
  "stream": true,
  "model": "mon-mod√®le-g√©nial",
  # cha√Æne en minuscules avec des mots s√©par√©s par des tirets : ceci est l'identifiant du mod√®le
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "Que contient cette image ?"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdYAAAGcCAYAAABk2YF[REDACTED]"
            # Les images sont transmises sous forme de donn√©es encod√©es en base64
          }
        }
      ]
    },
    {
      "role": "assistant",
      "content": "L'image semble √™tre [REDACTED]"
    },
  ],
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "stream_options": {
    "include_usage": true
  },
  "metadata": "[Le m√™me dictionnaire que __metadata__]",
  "files": "[La m√™me liste que __files__]"
}


```

</details>

### `__user__`

Un `dictionnaire` contenant des informations sur l'utilisateur.

Notez que si la classe `UserValves` est d√©finie, son instance doit √™tre accessible via `__user__["valves"]`. Sinon, la cl√© `valves` est enti√®rement absente de `__user__`.

<details>
<summary>Exemple</summary>

```json
{
  "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "email": "cheesy_dude@openwebui.com",
  "name": "Patrick",
  "role": "user",
  # le r√¥le peut √™tre soit `user` soit `admin`
  "valves": "[l'instance de UserValve]"
}
```

</details>

### `__metadata__`

Un `dictionnaire` contenant des informations diverses sur le chat, le mod√®le, les fichiers, etc.

<details>
<summary>Exemple</summary>

```json
{
  "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "chat_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "message_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
  "session_id": "xxxxxxxxxxxxxxxxxxxx",
  "tool_ids": null,
  # tool_ids est une liste de cha√Ænes.
  "tool_servers": [],
  "files": "[Identique √† body['files']]",
  # Si aucun fichier n'est fourni, la cl√© files existe dans __metadata__ et sa valeur est []
  "features": {
    "image_generation": false,
    "code_interpreter": false,
    "web_search": false
  },
  "variables": {
    "{{USER_NAME}}": "cheesy_username",
    "{{USER_LOCATION}}": "Inconnu",
    "{{CURRENT_DATETIME}}": "2025-02-02 XX:XX:XX",
    "{{CURRENT_DATE}}": "2025-02-02",
    "{{CURRENT_TIME}}": "XX:XX:XX",
    "{{CURRENT_WEEKDAY}}": "Lundi",
    "{{CURRENT_TIMEZONE}}": "Europe/Berlin",
    "{{USER_LANGUAGE}}": "fr-FR"
  },
  "model": "[Identique √† __model__]",
  "direct": false,
  "function_calling": "natif",
  "type": "r√©ponse_utilisateur",
  "interface": "open-webui"
}

```

</details>

### `__model__`

Un `dictionnaire` contenant des informations sur le mod√®le.

<details>
<summary>Exemple</summary>

```json
{
  "id": "mon-mod√®le-g√©nial",
  "name": "Mon Mod√®le G√©nial",
  "object": "mod√®le",
  "created": 1746000000,
  "owned_by": "openai",
  # soit openai soit ollama
  "info": {
      "id": "mon-mod√®le-g√©nial",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "base_model_id": "gpt-4o",
      # c'est le nom du mod√®le desservi par le point d'acc√®s du mod√®le
      "name": "Mon Mod√®le G√©nial",
      "params": {
      "system": "Vous √™tes mon meilleur assistant. Vous r√©pondez [REDACTED]",
      "function_calling": "natif"
      # les options personnalis√©es apparaissent ici, par exemple "Top K"
      },
      "meta": {
      "profile_image_url": "/static/favicon.png",
      "description": "Description de mon-mod√®le-g√©nial",
      "capabilities": {
          "vision": true,
          "usage": true,
          "citations": true
      },
      "position": 17,
      "tags": [
          {
          "name": "pour_amis"
          },
          {
          "name": "vision_activ√©e"
          }
      ],
      "suggestion_prompts": null
      },
      "access_control": {
      "read": {
          "group_ids": [],
          "user_ids": []
      },
      "write": {
          "group_ids": [],
          "user_ids": []
      }
      },
      "is_active": true,
      "updated_at": 1740000000,
      "created_at": 1740000000
  },
  "preset": true,
  "actions": [],
  "tags": [
      {
          "name": "pour_amis"
      },
      {
          "name": "vision_enabled"
      }
  ]
}

```

</details>

### `__messages__`

Une `liste` des messages pr√©c√©dents.

Voir la valeur `body["messages"]` ci-dessus.


### `__chat_id__`

La `str` de l‚Äô`chat_id`.

Voir la valeur `__metadata__["chat_id"]` ci-dessus.

### `__session_id__`

La `str` de l‚Äô`session_id`.

Voir la valeur `__metadata__["session_id"]` ci-dessus.

### `__message_id__`

La `str` de l‚Äô`message_id`.

Voir la valeur `__metadata__["message_id"]` ci-dessus.

### `__event_emitter__`

Un `Callable` utilis√© pour afficher les informations d‚Äô√©v√©nement √† l‚Äôutilisateur.

### `__event_call__`

Un `Callable` utilis√© pour des `Actions`.

### `__files__`

Une `liste` de fichiers envoy√©s via le chat. Notez que les images ne sont pas consid√©r√©es comme des fichiers et sont envoy√©es directement au mod√®le dans la liste `body["messages"]`.

Le binaire r√©el du fichier ne fait pas partie des arguments pour des raisons de performance, mais le fichier reste accessible via son chemin si n√©cessaire. Par exemple, en utilisant `docker`, la syntaxe Python pour le chemin pourrait √™tre¬†:

```python
from pathlib import Path

the_file = Path(f"/app/backend/data/uploads/{__files__[0]["files"]["id"]}_{__files__[0]["files"]["filename"]}")
assert the_file.exists()
```

Notez que le m√™me dictionnaire de fichiers peut √©galement √™tre acc√©d√© via `__metadata__["files"]` (et sa valeur est `[]` si aucun fichier n'est envoy√©) ou via `body["files"]` (mais la cl√© `files` est totalement absente de `body` si aucun fichier n'est envoy√©).

<details>
<resume>Exemple</resume>

```json

[
  {
    "type": "file",
    "file": {
      "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "filename": "Napol√©on - Wikip√©dia.pdf",
      "user_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "hash": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",
      "data": {
        "content": "Napol√©on - Wikip√©dia\n\n\nNapol√©on Ier\n\nL'Empereur Napol√©on dans son bureau aux\nTuileries, 1812\n\nEmpereur des Fran√ßais\n\n1er r√®gne 18 mai 1804 ‚Äì 6 avril 1814\n\nSuccesseur Louis XVIII[a]\n\n2√®me r√®gne 20 mars 1815¬†‚Äì 22¬†juin 1815\n\nSuccesseur Louis XVIII[a]\n\nPremier Consul de la R√©publique fran√ßaise\n\nEn fonction\n13 d√©cembre 1799¬†‚Äì 18 mai 1804\n\nN√© Napoleone Buonaparte\n15 ao√ªt 1769\nAjaccio, Corse, Royaume de\nFrance\n\nD√©c√©d√© 5 mai 1821 (51 ans)\nLongwood, Sainte-H√©l√®ne\n\nInhumation 15 d√©cembre 1840\nLes Invalides, Paris\n\nNapol√©on\nNapol√©on Bonaparte[b] (n√© Napoleone\nBuonaparte;[1][c] 15 ao√ªt 1769 ‚Äì 5 mai 1821), plus tard\ndit [REDACTED]",
        # La valeur de contenu est la sortie du parseur de document, l‚Äôexemple ci-dessus est avec Tika comme parseur de document
      },
      "meta": {
        "name": "Napol√©on - Wikip√©dia.pdf",
        "content_type": "application/pdf",
        "size": 10486578,
        # en bytes, ici environ 10Mo
        "data": {},
        "collection_name": "file-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
        # commence toujours par file
      },
      "created_at": 1740000000,
      "updated_at": 1740000000
    },
    "id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "url": "/api/v1/files/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "name": "Napol√©on - Wikip√©dia.pdf",
    "collection_name": "file-96xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    "status": "upload√©",
    "size": 10486578,
    "error": "",
    "itemId": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
    # itemId est diff√©rent de file["id"]
  }
]


```

</details>

### `__request__`

Une instance de `fastapi.Request`. Vous pouvez en lire davantage sur la [page de migration](../../features/plugin/migration/index.mdx) ou dans [la documentation de fastapi](https://fastapi.tiangolo.com/reference/request/).

### `__task__`

Un `str` pour le type de t√¢che. Sa valeur est juste un raccourci pour `__metadata__["task"]` si pr√©sent, sinon `None`.

<details>
<resume>Valeurs possibles</resume>

```json

[
    "title_generation",
    "tags_generation",
    "emoji_generation",
    "query_generation",
    "image_prompt_generation",
    "autocomplete_generation",
    "function_calling",
    "moa_response_generation"
]
```

</details>

### `__task_body__`

Un `dictionnaire` contenant le `body` n√©cessaire pour accomplir une donn√©e `__task__`. Sa valeur est juste un raccourci pour `__metadata__["task_body"]` si pr√©sent, sinon `None`.

Sa structure est la m√™me que `body` ci-dessus, avec des modifications comme l‚Äôutilisation du mod√®le appropri√© et le message syst√®me, etc.


### `__tools__`

Une `liste` d‚Äôinstances `ToolUserModel`.

Pour plus de d√©tails sur les attributs des instances de `ToolUserModel`, le code peut √™tre trouv√© dans [tools.py](https://github.com/open-webui/open-webui/blob/main/backend/open_webui/models/tools.py).

